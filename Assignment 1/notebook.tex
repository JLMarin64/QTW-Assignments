
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Assignment 1 Write Up}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    Real-Time Location System Case Study 1

Cho Kim, Jason Lin, Jonathan Marin

January, 18 2019

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{k+kn}{library}\PY{p}{(}IRdisplay\PY{p}{)}
         
         display\PYZus{}html\PY{p}{(}
         \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZlt{}script\PYZgt{}  }
         \PY{l+s}{code\PYZus{}show=true; }
         \PY{l+s}{function code\PYZus{}toggle() \PYZob{}}
         \PY{l+s}{  if (code\PYZus{}show)\PYZob{}}
         \PY{l+s}{    \PYZdl{}(\PYZbs{}\PYZsq{}div.input\PYZbs{}\PYZsq{}).hide();}
         \PY{l+s}{  \PYZcb{} else \PYZob{}}
         \PY{l+s}{    \PYZdl{}(\PYZbs{}\PYZsq{}div.input\PYZbs{}\PYZsq{}).show();}
         \PY{l+s}{  \PYZcb{}}
         \PY{l+s}{  code\PYZus{}show = !code\PYZus{}show}
         \PY{l+s}{\PYZcb{}  }
         \PY{l+s}{\PYZdl{}( document ).ready(code\PYZus{}toggle);}
         \PY{l+s}{\PYZlt{}/script\PYZgt{}}
         \PY{l+s}{  \PYZlt{}form action=\PYZdq{}javascript:code\PYZus{}toggle()\PYZdq{}\PYZgt{}}
         \PY{l+s}{    \PYZlt{}input type=\PYZdq{}submit\PYZdq{} value=\PYZdq{}Click here to toggle on/off the raw code.\PYZdq{}\PYZgt{}}
         \PY{l+s}{ \PYZlt{}/form\PYZgt{}\PYZsq{}}
         \PY{p}{)}
\end{Verbatim}


    
    
    \subsection{1 Introduction}\label{introduction}

    There is a growing need to track the location of people inside
buildings. Since global positioning systems (GPS) use signals obtained
from satellites to determine the user's location at a point in time, GPS
signals become scattered inside buildings due to roofs, walls, etc. that
they are unable to accurately track a user's location inside a building.
Indoor positioning systems (IPS) must be used in lieu of GPS to track
people reliably within buildings. IPS uses "WiFi signals detected from
network access points" {[}1{]} to locate devices on the network in real
time.

The datasets used for this case study were available on the Community
Resource for Archiving Wireless Data at Dartmouth (CRAWDAD) website. For
this case study, the dataset was downloaded from the course textbook's
website: http://rdatasciencecases.org/Data.html. The dataset is
described as "traces of signal strength of 802.11 APs for the COMPASS
positioning system." {[}2{]} By measuring the signal strength at known
points throughout the building, an IPS can be built by training the
model. The model to predict the location of a device will be based on
the signal strength between the device and the different access points.
This case study will focus on using k nearest neighbors (KNN) to predict
the location of the device.

The KNN algorithm searches through the entire training set for
classification using the signal strength, location, orientation, and
access points variables. Firstly, a number \texttt{k} must be selected
manually. The \texttt{k} determines how many neighbors will be included
when trying to predict the location on the test set. The training
dataset will be used to calculate the distance between the known
neighbors and the unknown location \texttt{(x,y)} on the test dataset
using the Euclidean distance formula:
\(\sqrt{(S_{1}^{*}-S_{1})^{2}+\cdots+(S_{6}^{*}-S_{6})^{2}}\). Once the
distance between the test data and train data is calculated, the
location can be predicted based on the majority vote of the nearest
neighbors.

    

    \subsection{2 Methods}\label{methods}

    For the case study, the offline dataset was imported to train and build
a model. After reviewing the import of the raw data file, values for
each variable were extracted; then, data cleaning and exploratory data
analysis were done. The signal strength was analyzed. The locations were
predicted using KNN and weighted KNN for the separate media access
control (MAC) addresses.

After the model is trained on the offline dataset, the effectiveness of
the location prediction was tested by using the online dataset. The
metric used to determine the fit of the model is the mean squared error
(MSE).

A question was posed to see if including certain MAC addresses will
increase or decrease the accuracy of the location using both a simple
average KNN and a weighted average KNN stated before. The metric that is
used to determine accuracy is the mean squared error (MSE),and therefore
a lower MSE indicates a better fit. Exploratory data analysis and
comparison of MSE are used to determine if the given MAC address have
any predictability power of location.

\paragraph{Data Description}\label{data-description}

\textbf{Offline Dataset}

The offline dataset "contains signal strengths measured using a
hand-held device on a grid of 166 points spaced 1 meter apart in the
hallways of one floor of a building at the University of Mannheim."
{[}1{]} The locations where the offline data was collected is denoted by
grey dots in Figure 1 below. The black squares in the floor plan below
denote the 6 fixed access points. For each access point, there were 110
signal strength measurements at 8 orientations (45 degree increments:
0°, 45°, 90°, 135°, 180°, 225° 270°, 315°) recorded by the hand-held
device. The textbook mentions that, "measurements from other hand-held
devices, e.g., phone or laptop, in the vicinity of the experimental unit
appear in some offline records." {[}1{]} These measurements should be
discarded in our dataset. Any observations that has an adhoc
characteristic was dropped from the dataset.

\textbf{Online Dataset}

For the online dataset, "60 locations and orientations {[}were{]} chosen
at random." {[}1{]} There were 110 signal strength measurements for each
location relative to the access point. The locations chosen at random
are denoted by the black dots on Figure 1 below.

\textbf{Figure 1: Floor Plan where Data Was Collected}

\textbf{Table 1: Dataset Description} Source: p.6 and Table 1.1: Units
of Measurement from textbook {[}1{]}

\begin{longtable}[]{@{}lll@{}}
\toprule
\begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Variable Name\strut
\end{minipage} & \begin{minipage}[b]{0.12\columnwidth}\raggedright\strut
Description\strut
\end{minipage} & \begin{minipage}[b]{0.74\columnwidth}\raggedright\strut
Units\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
t\strut
\end{minipage} & \begin{minipage}[t]{0.12\columnwidth}\raggedright\strut
Timestamp\strut
\end{minipage} & \begin{minipage}[t]{0.74\columnwidth}\raggedright\strut
timestamp in milliseconds since midnight, January 1, 1970 UTC\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
id\strut
\end{minipage} & \begin{minipage}[t]{0.12\columnwidth}\raggedright\strut
MACofScanDevice\strut
\end{minipage} & \begin{minipage}[t]{0.74\columnwidth}\raggedright\strut
MAC address of the scanning device\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
pos\strut
\end{minipage} & \begin{minipage}[t]{0.12\columnwidth}\raggedright\strut
RealPosition\strut
\end{minipage} & \begin{minipage}[t]{0.74\columnwidth}\raggedright\strut
the physical coordinate of the scanning device\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
degree\strut
\end{minipage} & \begin{minipage}[t]{0.12\columnwidth}\raggedright\strut
orientation\strut
\end{minipage} & \begin{minipage}[t]{0.74\columnwidth}\raggedright\strut
orientation of the user carrying the scanning device in degrees\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
MACofResponse1\strut
\end{minipage} & \begin{minipage}[t]{0.12\columnwidth}\raggedright\strut
SignalStrengthValue, Frequency, Mode\strut
\end{minipage} & \begin{minipage}[t]{0.74\columnwidth}\raggedright\strut
MAC address of a responding peer (e.g., an access point or a device in
adhoc mode) with the corresponding values for signal strength in dBm
(Decibel-milliwatts), the channel frequency and its mode (access point =
3, device in adhoc mode = 1)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
MACofResponseN\strut
\end{minipage} & \begin{minipage}[t]{0.12\columnwidth}\raggedright\strut
SignalStrengthValue, Frequency, Mode\strut
\end{minipage} & \begin{minipage}[t]{0.74\columnwidth}\raggedright\strut
MAC address of a responding peer (e.g., an access point or a device in
adhoc mode) with the corresponding values for signal strength in dBm
(Decibel-milliwatts), the channel frequency and its mode (access point =
3, device in adhoc mode = 1)\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

The table above describes both offline and online datasets. The table
contains the variables and the variable description for reference. The
table above also shows the data type, which will help when data
cleaning. Any conversions to string or numeric can be planned
accordingly.

\textbf{Figure 2: Screenshot of Raw Data File from Textbook}

 Figure 2 above shows that the first three rows in the raw data file
does not contain data points and only comments related to the data file.
The comments began with a \texttt{\#} symbol. Any line beginning with a
\texttt{\#} was discarded in the analysis since it is not an
observation. However, after the commments is where the data points can
be found. Since it is a text file, parsing of the text and converting
values to numeric must be done in order to have useable data for
modeling.

    \paragraph{Data Import}\label{data-import}

To train our model, the offline file was imported and read by R for each
line as text. The number of lines that began with a \texttt{\#} symbol
were counted using the \texttt{substr()} function. \texttt{5,312} lines
began with a \texttt{\#} in the offline file. There was a total of
\texttt{151,392} lines in the file. The textbook states that there
should be "\texttt{146,080} lines in the file." This was verified by
calculating the number of expected lines in the file
(\(166\ locations * 8\ angles * 110\ recordings = 146,080\)). When the
number of lines that begin with \texttt{\#} is subtracted from the total
number of lines, this matches the expected number of observations in the
file.

\paragraph{Data Processing}\label{data-processing}

The offline data file was processed by identifying that the data
elements were separated by a semicolon. Each data element contained the
variable name and the value separated by an equal sign. For each MAC
address, the signal strength, channel, and device type were separated by
a comma. Using the \texttt{strsplit()} function, the data elements were
separated by \texttt{;}, \texttt{=}, and \texttt{,}. The custom
\texttt{processLine} function from the textbook, returns a null value if
the token vector has 10 elements and separates the data by the special
characters mentioned. The dimensions of the offline data frame was
checked and verified that it matched the textbook. There were
\texttt{1181628} rows of data in the offline data frame at this time.

\paragraph{Data Cleaning}\label{data-cleaning}

As part of the data cleaning step, variable names were assigned to the
dataset and converted to the correct type. Table 2 shows the value and
the related device type. For the analysis, \texttt{adhoc} measurements
were removed from the offline data frame since only
\texttt{access\ point} is relevant for the case study and the
\texttt{type} variable was removed leaving \texttt{978,443} records in
the data frame.

\textbf{Table 2: Device Type Factors}

\begin{longtable}[]{@{}ll@{}}
\toprule
Device Type & Numerical Value\tabularnewline
\midrule
\endhead
adhoc & 1\tabularnewline
access point & 3\tabularnewline
\bottomrule
\end{longtable}

The \texttt{time} variable was converted from milliseconds to seconds to
match the \texttt{POSIXt} format. Below is a summary of the numeric
variables to verify that the data looks correct. From the summary output
below, the \texttt{posZ} values are all \texttt{0}. Because all
measurements were taken on one floor, there are no \texttt{posZ} values.
After analysis, the \texttt{posZ} variable was removed from the data
frame.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k+kp}{summary}\PY{p}{(}offline\PY{p}{[}\PY{p}{,} numVars\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
      time                          posX         posY           posZ  
 Min.   :2006-02-11 01:31:58   Min.   : 0   Min.   : 0.0   Min.   :0  
 1st Qu.:2006-02-11 07:21:27   1st Qu.: 2   1st Qu.: 3.0   1st Qu.:0  
 Median :2006-02-11 13:57:58   Median :12   Median : 6.0   Median :0  
 Mean   :2006-02-16 08:57:37   Mean   :14   Mean   : 5.9   Mean   :0  
 3rd Qu.:2006-02-19 08:52:40   3rd Qu.:23   3rd Qu.: 8.0   3rd Qu.:0  
 Max.   :2006-03-09 14:41:10   Max.   :33   Max.   :13.0   Max.   :0  
  orientation      signal   
 Min.   :  0   Min.   :-99  
 1st Qu.: 90   1st Qu.:-69  
 Median :180   Median :-60  
 Mean   :167   Mean   :-62  
 3rd Qu.:270   3rd Qu.:-53  
 Max.   :360   Max.   :-25  
    \end{verbatim}

    
    The character variables were converted to factors in the data frame. The
summary table of the character variables is below:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{k+kp}{summary}\PY{p}{(}\PY{k+kp}{sapply}\PY{p}{(}offline\PY{p}{[} \PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{mac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{,}
                        \PY{k+kp}{as.factor}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
                mac               channel                    scanMac      
 00:0f:a3:39:e1:c0:145862   2462000000:189774   00:02:2D:21:0F:33:978443  
 00:0f:a3:39:dd:cd:145619   2437000000:152124                             
 00:14:bf:b1:97:8a:132962   2412000000:145619                             
 00:14:bf:3b:c7:c6:126529   2432000000:126529                             
 00:14:bf:b1:97:90:122315   2427000000:122315                             
 00:14:bf:b1:97:8d:121325   2442000000:121325                             
 (Other)          :183831   (Other)   :120757                             
    \end{verbatim}

    
    There is only one MAC address for the \texttt{scanMac} variable since
there was only one hand-held device used to take measurements. The
\texttt{scanMac} variable was removed from the data frame.

    ** Orientation **

The observations for this dataset were measured at 8 equally spaced
orientations for each location. To check if this is correct, unique
values of the \texttt{orientation} variable were examined below. If the
data frame, were clean there would be no values returned. For further
examination, the \texttt{orientation} variable distribution was plotted
(see Figure 3). The plot of the empirical distribution function shows
that the orientation data points are distributed among the 8
orientations.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k+kp}{length}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}offline\PY{o}{\PYZdl{}}orientation\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    203

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} plot\PY{p}{(}ecdf\PY{p}{(}offline\PY{o}{\PYZdl{}}orientation\PY{p}{)}\PY{p}{,} main \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 3: Empirical CDF of Orientation \PYZbs{}nfor the Hand\PYZhy{}Held Device\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Empirical CDF\PYZdq{}}\PY{p}{,} xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation (degrees)\PYZdq{}}\PY{p}{,} axes\PY{o}{=}\PY{k+kc}{FALSE}\PY{p}{)}
         axis\PY{p}{(}side \PY{o}{=} \PY{l+m}{1}\PY{p}{,} at \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{360}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{)}\PY{p}{)}
         axis\PY{p}{(}\PY{l+m}{2}\PY{p}{)}
         box\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The below density plot displays the distribution of the signal for all
access points aggreagted for each orientation. The density curves shown
below highlight the signal strength.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} plot\PY{p}{(}density\PY{p}{(}offline\PY{o}{\PYZdl{}}orientation\PY{p}{,} bw \PY{o}{=} \PY{l+m}{2}\PY{p}{)}\PY{p}{,} 
              xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation (degrees)\PYZdq{}}\PY{p}{,} main \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 4: Density Plot for Orientation Angle\PYZdq{}}\PY{p}{,} axes\PY{o}{=}\PY{k+kc}{FALSE}\PY{p}{)}
         axis\PY{p}{(}side \PY{o}{=} \PY{l+m}{1}\PY{p}{,} at \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{360}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{)}\PY{p}{)}
         axis\PY{p}{(}\PY{l+m}{2}\PY{p}{)}
         box\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \textbf{Table 3: Number of Observations at Each Position}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} locCounts\PY{p}{[} \PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{8}\PY{p}{]}
\end{Verbatim}


    \begin{tabular}{r|llllllll}
	posX & 0 & 1 & 2 & 0 & 1 & 2 & 0 & 1\\
	posY & 0 & 0 & 0 & 1 & 1 & 1 & 2 & 2\\
	count & 5505 & 5505 & 5506 & 5524 & 5543 & 5558 & 5503 & 5564\\
\end{tabular}


    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{10}\PY{p}{,} \PY{l+m}{7}\PY{p}{,} \PY{l+m}{5}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         par\PY{p}{(}oldPar\PY{p}{)}
         locCounts \PY{o}{=} \PY{k+kp}{t}\PY{p}{(}locCounts\PY{p}{)}
         plot\PY{p}{(}locCounts\PY{p}{,} type \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{n\PYZdq{}}\PY{p}{,} xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{X coordinate\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Y coordinate\PYZdq{}}\PY{p}{,} main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 5: Counts of Signals Detected at Each Position\PYZbs{}n (Simulated floorplan)\PYZdq{}}\PY{p}{)}
         text\PY{p}{(}locCounts\PY{p}{,} labels \PY{o}{=} locCounts\PY{p}{[}\PY{p}{,}\PY{l+m}{3}\PY{p}{]}\PY{p}{,} cex \PY{o}{=} \PY{l+m}{.8}\PY{p}{,} srt \PY{o}{=} \PY{l+m}{45}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The above figure shows the number of observations detected for each
location.

    \subsection{3 Results}\label{results}

    \subsubsection{MAC Address 00:0f:a3:39:e1:c0 Distribution
Analysis}\label{mac-address-000fa339e1c0-distribution-analysis}

Based on the given location, the distribution can be compared to one
another to see if there is any predictive power in location. When
looking at the MAC Address \texttt{00:0f:a3:39:e1:c0}, we see from the
box plots that there is strong signal strength in that given location.
Indicating that it may predictive power for that given area. When
looking at the densities for the given MAC address, there is some normal
distributions but there is also good majority that is left skew. Also
when looking at the Mean Signal vs. Standard Deviation of Signal for the
given MAC address, there is some high variability in the stronger
signals.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{k+kn}{library}\PY{p}{(}IRdisplay\PY{p}{)}
         
         
         
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}BoxplotSignalByMacAngle.pdf\PYZdq{}, width = 7)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kn}{library}\PY{p}{(}lattice\PY{p}{)}
         bwplot\PY{p}{(}signal \PY{o}{\PYZti{}} \PY{k+kp}{factor}\PY{p}{(}angle\PY{p}{)} \PY{o}{|} mac\PY{p}{,} data \PY{o}{=} offlineRedo\PY{p}{,} xlab\PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Orientation (degrees)\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Signal (dBm)\PYZdq{}}\PY{p}{,} main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 6:\PYZbs{}n Signal Strength of 00:0f:a3:39:e1:c0 at Set Point\PYZdq{}}\PY{p}{,}
                subset \PY{o}{=} posX \PY{o}{==} \PY{l+m}{2} \PY{o}{\PYZam{}} posY \PY{o}{==} \PY{l+m}{12} 
                         \PY{o}{\PYZam{}} mac \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,} 
                layout \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,}\PY{l+m}{3}\PY{p}{)}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{k+kp}{summary}\PY{p}{(}offlineRedo\PY{o}{\PYZdl{}}signal\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}DensitySignalByMacAngle.pdf\PYZdq{}, width = 8, height = 12)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         densityplot\PY{p}{(} \PY{o}{\PYZti{}} signal \PY{o}{|} mac \PY{o}{+} \PY{k+kp}{factor}\PY{p}{(}angle\PY{p}{)}\PY{p}{,} data \PY{o}{=} offlineRedo\PY{p}{,} xlab\PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Orientation (degrees)\PYZdq{}}\PY{p}{,} main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 7: \PYZbs{}n Density Graph of 00:0f:a3:39:e1:c0\PYZdq{}}\PY{p}{,}
                      subset \PY{o}{=} posX \PY{o}{==} \PY{l+m}{24} \PY{o}{\PYZam{}} posY \PY{o}{==} \PY{l+m}{4} \PY{o}{\PYZam{}} 
                                  mac \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,}
                      bw \PY{o}{=} \PY{l+m}{0.5}\PY{p}{,} plot.points \PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    -93     -64     -58     -58     -51     -25 
    \end{verbatim}

    
    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{c+c1}{\PYZsh{}offline = offline[ offline\PYZdl{}mac != \PYZdq{}00:0f:a3:39:dd:cd\PYZdq{}, ]}
         
         offlineRedo\PY{o}{\PYZdl{}}posXY \PY{o}{=} \PY{k+kp}{paste}\PY{p}{(}offlineRedo\PY{o}{\PYZdl{}}posX\PY{p}{,} offlineRedo\PY{o}{\PYZdl{}}posY\PY{p}{,} sep \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}\PYZdq{}}\PY{p}{)}
         
         byLocAngleAPRedo \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offlineRedo\PY{p}{,} 
                             \PY{k+kp}{by}\PY{p}{(}offlineRedo\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{,} angle\PY{p}{,} mac\PY{p}{)}\PY{p}{,} 
                                \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} signalSummaryRedo \PY{o}{=} 
           \PY{k+kp}{lapply}\PY{p}{(}byLocAngleAPRedo\PY{p}{,}            
                  \PY{k+kr}{function}\PY{p}{(}oneLoc\PY{p}{)} \PY{p}{\PYZob{}}
                    ans \PY{o}{=} oneLoc\PY{p}{[}\PY{l+m}{1}\PY{p}{,} \PY{p}{]}
                    ans\PY{o}{\PYZdl{}}medSignal \PY{o}{=} median\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}avgSignal \PY{o}{=} \PY{k+kp}{mean}\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}num \PY{o}{=} \PY{k+kp}{length}\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}sdSignal \PY{o}{=} sd\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}iqrSignal \PY{o}{=} IQR\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans
                    \PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    When concentrating on the MAC address \texttt{00:0f:a3:39:e1:c0}, the
standard deviation (SD) signal was compared to the average signal where
the average signal was binned into category variables evenly. We can see
that with the lower signals, the variability is less with smaller
standard deviations while the stronger signals have more variability
with higher standard deviations.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} offlineSummaryRedo \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} signalSummaryRedo\PY{p}{)}     
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}BoxplotSignalSDByAvg.pdf\PYZdq{}, width = 10)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         breaks \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}90}\PY{p}{,} \PY{l+m}{\PYZhy{}30}\PY{p}{,} by \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
         bwplot\PY{p}{(}sdSignal \PY{o}{\PYZti{}} \PY{k+kp}{cut}\PY{p}{(}avgSignal\PY{p}{,} breaks \PY{o}{=} breaks\PY{p}{)}\PY{p}{,}
                data \PY{o}{=} offlineSummaryRedo\PY{p}{,} 
                subset \PY{o}{=} mac \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,}main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 8: Box Plot of 00:0f:a3:39:e1:c0\PYZdq{}}\PY{p}{,}
                xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Mean Signal\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{SD Signal\PYZdq{}}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}ScatterMean\PYZhy{}Median.pdf\PYZdq{}, width = 10)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{4.1}\PY{p}{,} \PY{l+m}{4.1}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kp}{with}\PY{p}{(}offlineSummaryRedo\PY{p}{,}
              smoothScatter\PY{p}{(}\PY{p}{(}avgSignal \PY{o}{\PYZhy{}} medSignal\PY{p}{)} \PY{o}{\PYZti{}} num\PY{p}{,} 
                            xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Number of Observations\PYZdq{}}\PY{p}{,} 
                            ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{mean \PYZhy{} median\PYZdq{}}\PY{p}{)}\PY{p}{)}
         abline\PY{p}{(}h \PY{o}{=} \PY{l+m}{0}\PY{p}{,} col \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}984ea3\PYZdq{}}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
         lo.obj \PY{o}{=} 
           \PY{k+kp}{with}\PY{p}{(}offlineSummaryRedo\PY{p}{,}
                loess\PY{p}{(}diff \PY{o}{\PYZti{}} num\PY{p}{,} 
                      data \PY{o}{=} \PY{k+kt}{data.frame}\PY{p}{(}diff \PY{o}{=} \PY{p}{(}avgSignal \PY{o}{\PYZhy{}} medSignal\PY{p}{)}\PY{p}{,}
                                        num \PY{o}{=} num\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         lo.obj.pr \PY{o}{=} predict\PY{p}{(}lo.obj\PY{p}{,} newdata \PY{o}{=} \PY{k+kt}{data.frame}\PY{p}{(}num \PY{o}{=} \PY{p}{(}\PY{l+m}{70}\PY{o}{:}\PY{l+m}{120}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         lines\PY{p}{(}x \PY{o}{=} \PY{l+m}{70}\PY{o}{:}\PY{l+m}{120}\PY{p}{,} y \PY{o}{=} lo.obj.pr\PY{p}{,} col \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}4daf4a\PYZdq{}}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{null device:} 1

    
    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_28_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{MAC Address 00:0f:a3:39:dd:cd Distribution
Analysis}\label{mac-address-000fa339ddcd-distribution-analysis}

Based on the graphs show below, with the given MAC Address
\texttt{00:0f:a3:39:dd:cd}, there is low signal strength at the given
location. Also when looking at the density graphs, the given MAC Address
seems to have more left skewness in many of its distribution. Also when
looking at the box of the average signal and standard deviation, there
seems to be high variability in the low signal strength with also high
variability in the high signal strength. This could indicate better
predictability of location since there is more variability in the low
signal strength area.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}BoxplotSignalByMacAngle.pdf\PYZdq{}, width = 7)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kn}{library}\PY{p}{(}lattice\PY{p}{)}
         bwplot\PY{p}{(}signal \PY{o}{\PYZti{}} \PY{k+kp}{factor}\PY{p}{(}angle\PY{p}{)} \PY{o}{|} mac\PY{p}{,} data \PY{o}{=} offlinenew\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal (dBm)\PYZdq{}}\PY{p}{,} xlab\PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Orientation (degrees)\PYZdq{}}\PY{p}{,} main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 9: \PYZbs{}nSignal Strength of 00:0f:a3:39:dd:cd at Set Point\PYZdq{}}\PY{p}{,}
                subset \PY{o}{=} posX \PY{o}{==} \PY{l+m}{2} \PY{o}{\PYZam{}} posY \PY{o}{==} \PY{l+m}{12} 
                         \PY{p}{,} 
                layout \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,}\PY{l+m}{3}\PY{p}{)}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_30_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{k+kp}{summary}\PY{p}{(}offlinenew\PY{o}{\PYZdl{}}signal\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}DensitySignalByMacAngle.pdf\PYZdq{}, width = 8, height = 12)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         densityplot\PY{p}{(} \PY{o}{\PYZti{}} signal \PY{o}{|} mac \PY{o}{+} \PY{k+kp}{factor}\PY{p}{(}angle\PY{p}{)}\PY{p}{,} data \PY{o}{=} offlinenew\PY{p}{,} main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 10: \PYZbs{}n Density Graph of 00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,}
                      subset \PY{o}{=} posX \PY{o}{==} \PY{l+m}{24} \PY{o}{\PYZam{}} posY \PY{o}{==} \PY{l+m}{4}\PY{p}{,} xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal (dBm)\PYZdq{}}\PY{p}{,}
                      bw \PY{o}{=} \PY{l+m}{0.5}\PY{p}{,} plot.points \PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    -98     -69     -61     -61     -54     -25 
    \end{verbatim}

    
    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_31_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{c+c1}{\PYZsh{}offline = offline[ offline\PYZdl{}mac != \PYZdq{}00:0f:a3:39:dd:cd\PYZdq{}, ]}
         
         offlinenew\PY{o}{\PYZdl{}}posXY \PY{o}{=} \PY{k+kp}{paste}\PY{p}{(}offlinenew\PY{o}{\PYZdl{}}posX\PY{p}{,} offlinenew\PY{o}{\PYZdl{}}posY\PY{p}{,} sep \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}\PYZdq{}}\PY{p}{)}
         
         byLocAngleAPnew \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offlinenew\PY{p}{,} 
                             \PY{k+kp}{by}\PY{p}{(}offlinenew\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{,} angle\PY{p}{,} mac\PY{p}{)}\PY{p}{,} 
                                \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} signalSummarynew \PY{o}{=} 
           \PY{k+kp}{lapply}\PY{p}{(}byLocAngleAPnew\PY{p}{,}            
                  \PY{k+kr}{function}\PY{p}{(}oneLoc\PY{p}{)} \PY{p}{\PYZob{}}
                    ans \PY{o}{=} oneLoc\PY{p}{[}\PY{l+m}{1}\PY{p}{,} \PY{p}{]}
                    ans\PY{o}{\PYZdl{}}medSignal \PY{o}{=} median\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}avgSignal \PY{o}{=} \PY{k+kp}{mean}\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}num \PY{o}{=} \PY{k+kp}{length}\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}sdSignal \PY{o}{=} sd\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}iqrSignal \PY{o}{=} IQR\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans
                    \PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} offlineSummarynew \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} signalSummarynew\PY{p}{)}     
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}BoxplotSignalSDByAvg.pdf\PYZdq{}, width = 10)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         breaks \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}90}\PY{p}{,} \PY{l+m}{\PYZhy{}30}\PY{p}{,} by \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
         bwplot\PY{p}{(}sdSignal \PY{o}{\PYZti{}} \PY{k+kp}{cut}\PY{p}{(}avgSignal\PY{p}{,} breaks \PY{o}{=} breaks\PY{p}{)}\PY{p}{,}main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 11: \PYZbs{}n Box Plot of 00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,}
                data \PY{o}{=} offlineSummarynew\PY{p}{,} 
                
                xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Mean Signal\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{SD Signal\PYZdq{}}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}ScatterMean\PYZhy{}Median.pdf\PYZdq{}, width = 10)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{4.1}\PY{p}{,} \PY{l+m}{4.1}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kp}{with}\PY{p}{(}offlineSummarynew\PY{p}{,}
              smoothScatter\PY{p}{(}\PY{p}{(}avgSignal \PY{o}{\PYZhy{}} medSignal\PY{p}{)} \PY{o}{\PYZti{}} num\PY{p}{,}
                            xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Number of Observations\PYZdq{}}\PY{p}{,} 
                            ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{mean \PYZhy{} median\PYZdq{}}\PY{p}{)}\PY{p}{)}
         abline\PY{p}{(}h \PY{o}{=} \PY{l+m}{0}\PY{p}{,} col \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}984ea3\PYZdq{}}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
         lo.obj \PY{o}{=} 
           \PY{k+kp}{with}\PY{p}{(}offlineSummarynew\PY{p}{,}
                loess\PY{p}{(}diff \PY{o}{\PYZti{}} num\PY{p}{,} 
                      data \PY{o}{=} \PY{k+kt}{data.frame}\PY{p}{(}diff \PY{o}{=} \PY{p}{(}avgSignal \PY{o}{\PYZhy{}} medSignal\PY{p}{)}\PY{p}{,}
                                        num \PY{o}{=} num\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         lo.obj.pr \PY{o}{=} predict\PY{p}{(}lo.obj\PY{p}{,} newdata \PY{o}{=} \PY{k+kt}{data.frame}\PY{p}{(}num \PY{o}{=} \PY{p}{(}\PY{l+m}{70}\PY{o}{:}\PY{l+m}{120}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         lines\PY{p}{(}x \PY{o}{=} \PY{l+m}{70}\PY{o}{:}\PY{l+m}{120}\PY{p}{,} y \PY{o}{=} lo.obj.pr\PY{p}{,} col \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}4daf4a\PYZdq{}}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{null device:} 1

    
    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Both MAC Address Distribution
Analysis}\label{both-mac-address-distribution-analysis}

When looking at the box plots for the set location, we can see that
there is some difference in signal strength between the two MAC Address.
This could indicate more predictability in the model since there is more
variability in the data and can pick up signals that the other could not
pick up. However, there is possibility the two signals could be similar
in a statistical sense, so more analysis would need to be done on this.
When looking at the box plot of Average Signal and Standard deviation of
signals, there seems to higher variability in the lower signal area
compared to the other MAC Addresses plots. This could indicate better
predictability since there is more ability to pick up signals in this
spectrum allowing for more accuracy in predictions of locations.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}BoxplotSignalByMacAngle.pdf\PYZdq{}, width = 7)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kn}{library}\PY{p}{(}lattice\PY{p}{)}
         bwplot\PY{p}{(}signal \PY{o}{\PYZti{}} \PY{k+kp}{factor}\PY{p}{(}angle\PY{p}{)} \PY{o}{|} mac\PY{p}{,} data \PY{o}{=} offlineBoth\PY{p}{,} xlab\PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Orientation (degrees)\PYZdq{}}\PY{p}{,}main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 12: \PYZbs{}n Signal Strength of Both MAC Addreess at Set Point\PYZdq{}}\PY{p}{,}
                subset \PY{o}{=} posX \PY{o}{==} \PY{l+m}{2} \PY{o}{\PYZam{}} posY \PY{o}{==} \PY{l+m}{12} 
                         \PY{p}{,} 
                layout \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,}\PY{l+m}{4}\PY{p}{)}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{k+kp}{summary}\PY{p}{(}offlineBoth\PY{o}{\PYZdl{}}signal\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}DensitySignalByMacAngle.pdf\PYZdq{}, width = 8, height = 12)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         densityplot\PY{p}{(} \PY{o}{\PYZti{}} signal \PY{o}{|} mac \PY{o}{+} \PY{k+kp}{factor}\PY{p}{(}angle\PY{p}{)}\PY{p}{,} data \PY{o}{=} offlineBoth\PY{p}{,} main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 13: \PYZbs{}n Density Graph of Both MAC Address\PYZdq{}}\PY{p}{,}
                      subset \PY{o}{=} posX \PY{o}{==} \PY{l+m}{24} \PY{o}{\PYZam{}} posY \PY{o}{==} \PY{l+m}{4}\PY{p}{,} xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal (dBm)\PYZdq{}}\PY{p}{,}
                      bw \PY{o}{=} \PY{l+m}{0.5}\PY{p}{,} plot.points \PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    -98     -67     -59     -60     -53     -25 
    \end{verbatim}

    
    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_37_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{}offline = offline[ offline\PYZdl{}mac != \PYZdq{}00:0f:a3:39:dd:cd\PYZdq{}, ]}
         
         offlineBoth\PY{o}{\PYZdl{}}posXY \PY{o}{=} \PY{k+kp}{paste}\PY{p}{(}offlineBoth\PY{o}{\PYZdl{}}posX\PY{p}{,} offlineBoth\PY{o}{\PYZdl{}}posY\PY{p}{,} sep \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}\PYZdq{}}\PY{p}{)}
         
         byLocAngleAPBoth \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offlineBoth\PY{p}{,} 
                             \PY{k+kp}{by}\PY{p}{(}offlineBoth\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{,} angle\PY{p}{,} mac\PY{p}{)}\PY{p}{,} 
                                \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} signalSummaryBoth \PY{o}{=} 
           \PY{k+kp}{lapply}\PY{p}{(}byLocAngleAPBoth\PY{p}{,}            
                  \PY{k+kr}{function}\PY{p}{(}oneLoc\PY{p}{)} \PY{p}{\PYZob{}}
                    ans \PY{o}{=} oneLoc\PY{p}{[}\PY{l+m}{1}\PY{p}{,} \PY{p}{]}
                    ans\PY{o}{\PYZdl{}}medSignal \PY{o}{=} median\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}avgSignal \PY{o}{=} \PY{k+kp}{mean}\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}num \PY{o}{=} \PY{k+kp}{length}\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}sdSignal \PY{o}{=} sd\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans\PY{o}{\PYZdl{}}iqrSignal \PY{o}{=} IQR\PY{p}{(}oneLoc\PY{o}{\PYZdl{}}signal\PY{p}{)}
                    ans
                    \PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} offlineSummaryBoth \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} signalSummaryBoth\PY{p}{)}     
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}BoxplotSignalSDByAvg.pdf\PYZdq{}, width = 10)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{3.1}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         breaks \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}90}\PY{p}{,} \PY{l+m}{\PYZhy{}30}\PY{p}{,} by \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
         bwplot\PY{p}{(}sdSignal \PY{o}{\PYZti{}} \PY{k+kp}{cut}\PY{p}{(}avgSignal\PY{p}{,} breaks \PY{o}{=} breaks\PY{p}{)}\PY{p}{,}main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 14:\PYZbs{}n Box Plot of 00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,}
                data \PY{o}{=} offlineSummaryBoth\PY{p}{,} 
                
                xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Mean Signal\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{SD Signal\PYZdq{}}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}ScatterMean\PYZhy{}Median.pdf\PYZdq{}, width = 10)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{4.1}\PY{p}{,} \PY{l+m}{4.1}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kp}{with}\PY{p}{(}offlineSummaryBoth\PY{p}{,}
              smoothScatter\PY{p}{(}\PY{p}{(}avgSignal \PY{o}{\PYZhy{}} medSignal\PY{p}{)} \PY{o}{\PYZti{}} num\PY{p}{,}
                            xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Number of Observations\PYZdq{}}\PY{p}{,} 
                            ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{mean \PYZhy{} median\PYZdq{}}\PY{p}{)}\PY{p}{)}
         abline\PY{p}{(}h \PY{o}{=} \PY{l+m}{0}\PY{p}{,} col \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}984ea3\PYZdq{}}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
         lo.obj \PY{o}{=} 
           \PY{k+kp}{with}\PY{p}{(}offlineSummaryBoth\PY{p}{,}
                loess\PY{p}{(}diff \PY{o}{\PYZti{}} num\PY{p}{,} 
                      data \PY{o}{=} \PY{k+kt}{data.frame}\PY{p}{(}diff \PY{o}{=} \PY{p}{(}avgSignal \PY{o}{\PYZhy{}} medSignal\PY{p}{)}\PY{p}{,}
                                        num \PY{o}{=} num\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         lo.obj.pr \PY{o}{=} predict\PY{p}{(}lo.obj\PY{p}{,} newdata \PY{o}{=} \PY{k+kt}{data.frame}\PY{p}{(}num \PY{o}{=} \PY{p}{(}\PY{l+m}{70}\PY{o}{:}\PY{l+m}{120}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         lines\PY{p}{(}x \PY{o}{=} \PY{l+m}{70}\PY{o}{:}\PY{l+m}{120}\PY{p}{,} y \PY{o}{=} lo.obj.pr\PY{p}{,} col \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}4daf4a\PYZdq{}}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{null device:} 1

    
    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_40_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Accuracy of Location
Prediction}\label{accuracy-of-location-prediction}

    When using the three different set of data, we use the function
calcError() to estimate the mean square error between the prediction and
the actuals. The following MSE for including only MAC Addresss
\texttt{00:0f:a3:39:e1:c0} is \texttt{272.40}. the following MSE for
including only MAC Address \texttt{00:0f:a3:39:dd:cd} is
\texttt{252.33}. The following MSE for including both MAC Address is
\texttt{211.17}.

When using the weighted average using the inverse of the distance
obtained from the KNN model.The following MSE for including only MAC
Addresss \texttt{00:0f:a3:39:e1:c0} is the value \texttt{271.27}. the
following MSE for including only MAC Address \texttt{00:0f:a3:39:dd:cd}
is the value \texttt{242.40}. The following MSE for including both MAC
Address is the value \texttt{207.25}.

As a side note, when looking at the k-fold cross validation using the
offline data set as the training data to determine the number of
neighbors to use that would minimize the MSE. It is found that keeping
number of angles = 3, the number of neighbors used that would minimize
MSE is 6 (please see figure below). In the figure, the y-axis the MSE
and the X-axis is the number of neighbors. Therefore, all analysis done
on accuracy of location prediction is using 6 nearest neighbors as the
model.

\textbf{Figure 15: Screenshot of the CV KNN}

    \subsection{4 Conclusion}\label{conclusion}

    When looking at the different plots it seems to show that the more
variability in all ranges of the signal strength the better
predictability of the location. However, therefore from the plots alone
having Both MAC Addresses seems to have better predictability since the
box plots show this in the case of average signal strength vs. standard
deviation of signal strength. When looking at the box plots for signal
strength based on one location, the both MaC Address data set seems to
show better predictability. This is further supported when looking at
the MSE using the simple average for the location for the nearest
neighbors where the both MAC Address data set has the lowest MSE.

In concern with the new weighted average methodology, the code was found
in a GitHub repository please see the reference. The methodology that it
uses is similar to what is referenced in the Nolan Text. The code
utilizes the Euclidean distances that is calculated from the KNN
function. From there the weights are calculated accordingly and times
with the corresponding X and Y coordinates and summed with the number of
neighbors to obtain the average. The MSE shows that is has decreased it
by a few points. Indicating that the weighting of closer points leads to
a more accurate prediction of location. The new weighted average
methodology still shows that having both MAC Address in the data set has
the lowest MSE.

    

    \subsection{Appendix}\label{appendix}

    \subsubsection{References}\label{references}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Nolan, Deborah, and Duncan Temple Lang. Data Science in R: a Case
  Studies Approach to Computational Reasoning and Problem Solving. Crc
  Press Inc., 2015.
\item
  Thomas King, Stephan Kopf, Thomas Haenselmann, Christian Lubberger,
  Wolfgang Effelsberg, CRAWDAD dataset mannheim/compass (v. 2008‑04‑11),
  downloaded from https://crawdad.org/mannheim/compass/20080411, Apr
  2008.
\item
  Yao, Yao, et al. ``Case Study Unit 6 - Real-Time Location System.''
  GitHub, 18 June 2018,
  https://github.com/yaowser/qtw/blob/master/Yao\%20Kruse\%20Angelov\%20MSDS\%207333\%20402\%20CS6\%20RTLS.ipynb.
\item
  Code Obtained from http://www.rdatasciencecases.org/GeoLoc/code.R
\end{enumerate}

    \subsubsection{Code}\label{code}

    \subsubsection{Generic Code to Pull Raw}\label{generic-code-to-pull-raw}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k+kn}{library}\PY{p}{(}IRdisplay\PY{p}{)}
         
         display\PYZus{}html\PY{p}{(}
         \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZlt{}script\PYZgt{}  }
         \PY{l+s}{code\PYZus{}show=true; }
         \PY{l+s}{function code\PYZus{}toggle() \PYZob{}}
         \PY{l+s}{  if (code\PYZus{}show)\PYZob{}}
         \PY{l+s}{    \PYZdl{}(\PYZbs{}\PYZsq{}div.input\PYZbs{}\PYZsq{}).hide();}
         \PY{l+s}{  \PYZcb{} else \PYZob{}}
         \PY{l+s}{    \PYZdl{}(\PYZbs{}\PYZsq{}div.input\PYZbs{}\PYZsq{}).show();}
         \PY{l+s}{  \PYZcb{}}
         \PY{l+s}{  code\PYZus{}show = !code\PYZus{}show}
         \PY{l+s}{\PYZcb{}  }
         \PY{l+s}{\PYZdl{}( document ).ready(code\PYZus{}toggle);}
         \PY{l+s}{\PYZlt{}/script\PYZgt{}}
         \PY{l+s}{  \PYZlt{}form action=\PYZdq{}javascript:code\PYZus{}toggle()\PYZdq{}\PYZgt{}}
         \PY{l+s}{    \PYZlt{}input type=\PYZdq{}submit\PYZdq{} value=\PYZdq{}Click here to toggle on/off the raw code.\PYZdq{}\PYZgt{}}
         \PY{l+s}{ \PYZlt{}/form\PYZgt{}\PYZsq{}}
         \PY{p}{)}
         
         \PY{k+kp}{options}\PY{p}{(}digits \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
         
         txt \PY{o}{=} \PY{k+kp}{readLines}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{offline.final.trace.txt\PYZdq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}use substr function to locate lines that begin with \PYZsh{} and tally them}
         \PY{k+kp}{sum}\PY{p}{(}\PY{k+kp}{substr}\PY{p}{(}txt\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}\PYZdq{}}\PY{p}{)}
         \PY{k+kp}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Number of lines that begin with \PYZsh{}: \PYZdq{}}\PY{p}{,}\PY{k+kp}{sum}\PY{p}{(}\PY{k+kp}{substr}\PY{p}{(}txt\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}\PYZdq{}}\PY{p}{)}\PY{p}{)}
         \PY{k+kp}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Number of lines in offline file: \PYZdq{}}\PY{p}{,}\PY{k+kp}{length}\PY{p}{(}txt\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{}    Begin data cleaning step     \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         
         \PY{c+c1}{\PYZsh{} evaluate how semi\PYZhy{}colon splits 4th line of data file (first line that\PYZsq{}s not a comment)}
         \PY{k+kp}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Output of strsplit on 4th line below\PYZdq{}}\PY{p}{)}
         \PY{k+kp}{strsplit}\PY{p}{(}txt\PY{p}{[}\PY{l+m}{4}\PY{p}{]}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{;\PYZdq{}}\PY{p}{)}\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}
         
         \PY{c+c1}{\PYZsh{} split data at a ; or = or , character}
         tokens \PY{o}{=} \PY{k+kp}{strsplit}\PY{p}{(}txt\PY{p}{[}\PY{l+m}{4}\PY{p}{]}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{[;=,]\PYZdq{}}\PY{p}{)}\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}
         
         \PY{c+c1}{\PYZsh{} print first 10 elements of variable, tokens that give info about handheld device}
         tokens\PY{p}{[}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{10}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} extract values of the variables}
         tokens\PY{p}{[}\PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{4}\PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{8}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} review remaining values in split vector}
         tokens\PY{p}{[} \PY{o}{\PYZhy{}} \PY{p}{(} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{10} \PY{p}{)} \PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} create matrix}
         tmp \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}tokens\PY{p}{[} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{10}\PY{p}{)} \PY{p}{]}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{4}\PY{p}{,} byrow \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}
         mat \PY{o}{=} \PY{k+kp}{cbind}\PY{p}{(}\PY{k+kt}{matrix}\PY{p}{(}tokens\PY{p}{[}\PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{4}\PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{8}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{]}\PY{p}{,} nrow \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}tmp\PY{p}{)}\PY{p}{,}
                            ncol \PY{o}{=} \PY{l+m}{6}\PY{p}{,} byrow \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}\PY{p}{,} 
                     tmp\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} confirm dimensions of matrix}
         \PY{k+kp}{dim}\PY{p}{(}mat\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} create function processLine to repeat for all rows in txt}
         processLine \PY{o}{=}
           \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)}
           \PY{p}{\PYZob{}}
             tokens \PY{o}{=} \PY{k+kp}{strsplit}\PY{p}{(}x\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{[;=,]\PYZdq{}}\PY{p}{)}\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}
             tmp \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}tokens\PY{p}{[} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{10}\PY{p}{)} \PY{p}{]}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{4}\PY{p}{,} byrow \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}
             \PY{k+kp}{cbind}\PY{p}{(}\PY{k+kt}{matrix}\PY{p}{(}tokens\PY{p}{[}\PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{4}\PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{8}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{]}\PY{p}{,} nrow \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}tmp\PY{p}{)}\PY{p}{,}
                          ncol \PY{o}{=} \PY{l+m}{6}\PY{p}{,} byrow \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}\PY{p}{,} tmp\PY{p}{)}
           \PY{p}{\PYZcb{}}
         
         \PY{c+c1}{\PYZsh{} apply function to txt}
         tmp \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}txt\PY{p}{[}\PY{l+m}{4}\PY{o}{:}\PY{l+m}{20}\PY{p}{]}\PY{p}{,} processLine\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} determine \PYZsh{} of signals detected at each point}
         \PY{k+kp}{sapply}\PY{p}{(}tmp\PY{p}{,} \PY{k+kp}{nrow}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} create offline dataframe}
         offline \PY{o}{=} \PY{k+kp}{as.data.frame}\PY{p}{(}\PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} tmp\PY{p}{)}\PY{p}{)}
         \PY{k+kp}{dim}\PY{p}{(}offline\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} discard lines beginning with \PYZsh{} because they are comments}
         lines \PY{o}{=} txt\PY{p}{[} \PY{k+kp}{substr}\PY{p}{(}txt\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)} \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}\PYZdq{}} \PY{p}{]}
         
         tmp \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}lines\PY{p}{,} processLine\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} revised function to discard observations with no signal detected}
         processLine \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)}
         \PY{p}{\PYZob{}}
           tokens \PY{o}{=} \PY{k+kp}{strsplit}\PY{p}{(}x\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{[;=,]\PYZdq{}}\PY{p}{)}\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}
           
           \PY{k+kr}{if} \PY{p}{(}\PY{k+kp}{length}\PY{p}{(}tokens\PY{p}{)} \PY{o}{==} \PY{l+m}{10}\PY{p}{)} 
             \PY{k+kr}{return}\PY{p}{(}\PY{k+kc}{NULL}\PY{p}{)}
           
           tmp \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}tokens\PY{p}{[} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{10}\PY{p}{)} \PY{p}{]}\PY{p}{,} \PY{p}{,} \PY{l+m}{4}\PY{p}{,} byrow \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}
           \PY{k+kp}{cbind}\PY{p}{(}\PY{k+kt}{matrix}\PY{p}{(}tokens\PY{p}{[}\PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{4}\PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{8}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{k+kp}{nrow}\PY{p}{(}tmp\PY{p}{)}\PY{p}{,} \PY{l+m}{6}\PY{p}{,} 
                        byrow \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}\PY{p}{,} tmp\PY{p}{)}
         \PY{p}{\PYZcb{}}
         
         \PY{k+kp}{options}\PY{p}{(}error \PY{o}{=} recover\PY{p}{,} warn \PY{o}{=} \PY{l+m}{1}\PY{p}{)}
         tmp \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}lines\PY{p}{,} processLine\PY{p}{)}
         offline \PY{o}{=} \PY{k+kp}{as.data.frame}\PY{p}{(}\PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} tmp\PY{p}{)}\PY{p}{,} 
                                 stringsAsFactors \PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)}
\end{Verbatim}


    
    
    5312

    
    'Number of lines that begin with \#:  5312'

    
    'Number of lines in offline file:  151392'

    
    \begin{Verbatim}[commandchars=\\\{\}]
[1] "Output of strsplit on 4th line below"

    \end{Verbatim}

    \begin{enumerate*}
\item 't=1139643118358'
\item 'id=00:02:2D:21:0F:33'
\item 'pos=0.0,0.0,0.0'
\item 'degree=0.0'
\item '00:14:bf:b1:97:8a=-38,2437000000,3'
\item '00:14:bf:b1:97:90=-56,2427000000,3'
\item '00:0f:a3:39:e1:c0=-53,2462000000,3'
\item '00:14:bf:b1:97:8d=-65,2442000000,3'
\item '00:14:bf:b1:97:81=-65,2422000000,3'
\item '00:14:bf:3b:c7:c6=-66,2432000000,3'
\item '00:0f:a3:39:dd:cd=-75,2412000000,3'
\item '00:0f:a3:39:e0:4b=-78,2462000000,3'
\item '00:0f:a3:39:e2:10=-87,2437000000,3'
\item '02:64:fb:68:52:e6=-88,2447000000,1'
\item '02:00:42:55:31:00=-84,2457000000,1'
\end{enumerate*}


    
    \begin{enumerate*}
\item 't'
\item '1139643118358'
\item 'id'
\item '00:02:2D:21:0F:33'
\item 'pos'
\item '0.0'
\item '0.0'
\item '0.0'
\item 'degree'
\item '0.0'
\end{enumerate*}


    
    \begin{enumerate*}
\item '1139643118358'
\item '00:02:2D:21:0F:33'
\item '0.0'
\item '0.0'
\item '0.0'
\item '0.0'
\end{enumerate*}


    
    \begin{enumerate*}
\item '00:14:bf:b1:97:8a'
\item '-38'
\item '2437000000'
\item '3'
\item '00:14:bf:b1:97:90'
\item '-56'
\item '2427000000'
\item '3'
\item '00:0f:a3:39:e1:c0'
\item '-53'
\item '2462000000'
\item '3'
\item '00:14:bf:b1:97:8d'
\item '-65'
\item '2442000000'
\item '3'
\item '00:14:bf:b1:97:81'
\item '-65'
\item '2422000000'
\item '3'
\item '00:14:bf:3b:c7:c6'
\item '-66'
\item '2432000000'
\item '3'
\item '00:0f:a3:39:dd:cd'
\item '-75'
\item '2412000000'
\item '3'
\item '00:0f:a3:39:e0:4b'
\item '-78'
\item '2462000000'
\item '3'
\item '00:0f:a3:39:e2:10'
\item '-87'
\item '2437000000'
\item '3'
\item '02:64:fb:68:52:e6'
\item '-88'
\item '2447000000'
\item '1'
\item '02:00:42:55:31:00'
\item '-84'
\item '2457000000'
\item '1'
\end{enumerate*}


    
    \begin{enumerate*}
\item 11
\item 10
\end{enumerate*}


    
    \begin{enumerate*}
\item 11
\item 10
\item 10
\item 11
\item 9
\item 10
\item 9
\item 9
\item 10
\item 11
\item 11
\item 9
\item 9
\item 9
\item 8
\item 10
\item 14
\end{enumerate*}


    
    \begin{enumerate*}
\item 170
\item 10
\end{enumerate*}


    
    \begin{Verbatim}[commandchars=\\\{\}]
Warning message in matrix(tokens[c(2, 4, 6:8, 10)], nrow = nrow(tmp), ncol = 6, :
“data length exceeds size of matrix”Warning message in matrix(tokens[c(2, 4, 6:8, 10)], nrow = nrow(tmp), ncol = 6, :
“data length exceeds size of matrix”Warning message in matrix(tokens[c(2, 4, 6:8, 10)], nrow = nrow(tmp), ncol = 6, :
“data length exceeds size of matrix”Warning message in matrix(tokens[c(2, 4, 6:8, 10)], nrow = nrow(tmp), ncol = 6, :
“data length exceeds size of matrix”Warning message in matrix(tokens[c(2, 4, 6:8, 10)], nrow = nrow(tmp), ncol = 6, :
“data length exceeds size of matrix”Warning message in matrix(tokens[c(2, 4, 6:8, 10)], nrow = nrow(tmp), ncol = 6, :
“data length exceeds size of matrix”
    \end{Verbatim}

    \subsubsection{Creates the field names and also changes the formatting
of the variables to numeric since all were character before. Drops the
adhoc data and coverts the time to
milliseconds}\label{creates-the-field-names-and-also-changes-the-formatting-of-the-variables-to-numeric-since-all-were-character-before.-drops-the-adhoc-data-and-coverts-the-time-to-milliseconds}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{k+kp}{dim}\PY{p}{(}offline\PY{p}{)}
         
         \PY{k+kp}{names}\PY{p}{(}offline\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} 
                            \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{mac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} 
                            \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}}\PY{p}{)}
         
         numVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} 
                     \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{)}
         offline\PY{p}{[} numVars \PY{p}{]} \PY{o}{=}  \PY{k+kp}{lapply}\PY{p}{(}offline\PY{p}{[} numVars \PY{p}{]}\PY{p}{,} \PY{k+kp}{as.numeric}\PY{p}{)}
         
         offline \PY{o}{=} offline\PY{p}{[} offline\PY{o}{\PYZdl{}}type \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{3\PYZdq{}}\PY{p}{,} \PY{p}{]}
         offline \PY{o}{=} offline\PY{p}{[} \PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}} \PY{o}{!=} \PY{k+kp}{names}\PY{p}{(}offline\PY{p}{)} \PY{p}{]}
         \PY{k+kp}{dim}\PY{p}{(}offline\PY{p}{)}
         
         offline\PY{o}{\PYZdl{}}rawTime \PY{o}{=} offline\PY{o}{\PYZdl{}}time
         offline\PY{o}{\PYZdl{}}time \PY{o}{=} offline\PY{o}{\PYZdl{}}time\PY{o}{/}\PY{l+m}{1000}
         \PY{k+kp}{class}\PY{p}{(}offline\PY{o}{\PYZdl{}}time\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXt\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXct\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{enumerate*}
\item 1181628
\item 10
\end{enumerate*}


    
    \begin{enumerate*}
\item 978443
\item 9
\end{enumerate*}


    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} check variable types}
         \PY{k+kp}{unlist}\PY{p}{(}\PY{k+kp}{lapply}\PY{p}{(}offline\PY{p}{,} \PY{k+kp}{class}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kp}{summary}\PY{p}{(}offline\PY{p}{[}\PY{p}{,} numVars\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} convert character variables to factors}
         \PY{k+kp}{summary}\PY{p}{(}\PY{k+kp}{sapply}\PY{p}{(}offline\PY{p}{[} \PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{mac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{,}
                        \PY{k+kp}{as.factor}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{description*}
\item[time1] 'POSIXt'
\item[time2] 'POSIXct'
\item[scanMac] 'character'
\item[posX] 'numeric'
\item[posY] 'numeric'
\item[posZ] 'numeric'
\item[orientation] 'numeric'
\item[mac] 'character'
\item[signal] 'numeric'
\item[channel] 'character'
\item[rawTime] 'numeric'
\end{description*}


    
    
    \begin{verbatim}
      time                          posX         posY           posZ  
 Min.   :2006-02-11 01:31:58   Min.   : 0   Min.   : 0.0   Min.   :0  
 1st Qu.:2006-02-11 07:21:27   1st Qu.: 2   1st Qu.: 3.0   1st Qu.:0  
 Median :2006-02-11 13:57:58   Median :12   Median : 6.0   Median :0  
 Mean   :2006-02-16 08:57:37   Mean   :14   Mean   : 5.9   Mean   :0  
 3rd Qu.:2006-02-19 08:52:40   3rd Qu.:23   3rd Qu.: 8.0   3rd Qu.:0  
 Max.   :2006-03-09 14:41:10   Max.   :33   Max.   :13.0   Max.   :0  
  orientation      signal   
 Min.   :  0   Min.   :-99  
 1st Qu.: 90   1st Qu.:-69  
 Median :180   Median :-60  
 Mean   :167   Mean   :-62  
 3rd Qu.:270   3rd Qu.:-53  
 Max.   :360   Max.   :-25  
    \end{verbatim}

    
    
    \begin{verbatim}
                mac               channel                    scanMac      
 00:0f:a3:39:e1:c0:145862   2462000000:189774   00:02:2D:21:0F:33:978443  
 00:0f:a3:39:dd:cd:145619   2437000000:152124                             
 00:14:bf:b1:97:8a:132962   2412000000:145619                             
 00:14:bf:3b:c7:c6:126529   2432000000:126529                             
 00:14:bf:b1:97:90:122315   2427000000:122315                             
 00:14:bf:b1:97:8d:121325   2442000000:121325                             
 (Other)          :183831   (Other)   :120757                             
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{} eliminate posZ since all values = 0, measurements only taken on 1st floor.}
         \PY{c+c1}{\PYZsh{} eliminate scanMac since there is only one value}
         offline \PY{o}{=} offline\PY{p}{[} \PY{p}{,} \PY{o}{!}\PY{p}{(}\PY{k+kp}{names}\PY{p}{(}offline\PY{p}{)} \PY{o}{\PYZpc{}in\PYZpc{}} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{)}\PY{p}{)}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} check for 8 values for orientation angle should be every 45}
         \PY{k+kp}{length}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}offline\PY{o}{\PYZdl{}}orientation\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} examine distribution of orientation}
         \PY{c+c1}{\PYZsh{}png(filename = \PYZdq{}Geo\PYZus{}ECDFOrientation.png\PYZdq{}, width = 800, height = 679, units=\PYZdq{}px\PYZdq{}, res=100)}
         plot\PY{p}{(}ecdf\PY{p}{(}offline\PY{o}{\PYZdl{}}orientation\PY{p}{)}\PY{p}{,} main \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 3: Empirical CDF of Orientation \PYZbs{}nfor the Hand\PYZhy{}Held Device\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Empirical CDF\PYZdq{}}\PY{p}{,} xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} axes\PY{o}{=}\PY{k+kc}{FALSE}\PY{p}{)}
         axis\PY{p}{(}side \PY{o}{=} \PY{l+m}{1}\PY{p}{,} at \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{360}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{)}\PY{p}{)}
         axis\PY{p}{(}\PY{l+m}{2}\PY{p}{)}
         box\PY{p}{(}\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    203

    
    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_54_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Defines the roundOrientation Function and Graphs the
Orientation to ensure each orientation has its own
orientation}\label{defines-the-roundorientation-function-and-graphs-the-orientation-to-ensure-each-orientation-has-its-own-orientation}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}DensityOrientation.pdf\PYZdq{}, width = 10, height = 5)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{4}\PY{p}{,} \PY{l+m}{4}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         plot\PY{p}{(}density\PY{p}{(}offline\PY{o}{\PYZdl{}}orientation\PY{p}{,} bw \PY{o}{=} \PY{l+m}{2}\PY{p}{)}\PY{p}{,} 
              xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} main \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 4: Density Plot for Orientation Angle\PYZdq{}}\PY{p}{,} axes\PY{o}{=}\PY{k+kc}{FALSE}\PY{p}{)}
         axis\PY{p}{(}side \PY{o}{=} \PY{l+m}{1}\PY{p}{,} at \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{360}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{)}\PY{p}{)}
         axis\PY{p}{(}\PY{l+m}{2}\PY{p}{)}
         box\PY{p}{(}\PY{p}{)}
         par\PY{p}{(}oldPar\PY{p}{)}
         
         roundOrientation \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}angles\PY{p}{)} \PY{p}{\PYZob{}}
           refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{,} length  \PY{o}{=} \PY{l+m}{9}\PY{p}{)}
           q \PY{o}{=} \PY{k+kp}{sapply}\PY{p}{(}angles\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}o\PY{p}{)} \PY{k+kp}{which.min}\PY{p}{(}\PY{k+kp}{abs}\PY{p}{(}o \PY{o}{\PYZhy{}} refs\PY{p}{)}\PY{p}{)}\PY{p}{)}
           \PY{k+kt}{c}\PY{p}{(}refs\PY{p}{[}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{8}\PY{p}{]}\PY{p}{,} \PY{l+m}{0}\PY{p}{)}\PY{p}{[}\PY{k+kp}{q}\PY{p}{]}
         \PY{p}{\PYZcb{}}
         
         offline\PY{o}{\PYZdl{}}angle \PY{o}{=} roundOrientation\PY{p}{(}offline\PY{o}{\PYZdl{}}orientation\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}BoxplotAngle.pdf\PYZdq{}, width = 10)}
         oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{4}\PY{p}{,} \PY{l+m}{4}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         
         par\PY{p}{(}oldPar\PY{p}{)}
         dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \textbf{null device:} 1

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_56_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{k+kt}{c}\PY{p}{(}\PY{k+kp}{length}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}offline\PY{o}{\PYZdl{}}mac\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{k+kp}{length}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}offline\PY{o}{\PYZdl{}}channel\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kp}{table}\PY{p}{(}offline\PY{o}{\PYZdl{}}mac\PY{p}{)}
         
         subMacs \PY{o}{=} \PY{k+kp}{names}\PY{p}{(}\PY{k+kp}{sort}\PY{p}{(}\PY{k+kp}{table}\PY{p}{(}offline\PY{o}{\PYZdl{}}mac\PY{p}{)}\PY{p}{,} decreasing \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{7}\PY{p}{]}
         offline \PY{o}{=} offline\PY{p}{[} offline\PY{o}{\PYZdl{}}mac \PY{o}{\PYZpc{}in\PYZpc{}} subMacs\PY{p}{,} \PY{p}{]}
         
         macChannel \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offline\PY{p}{,} \PY{k+kp}{table}\PY{p}{(}mac\PY{p}{,} channel\PY{p}{)}\PY{p}{)}
         \PY{k+kp}{apply}\PY{p}{(}macChannel\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sum}\PY{p}{(}x \PY{o}{\PYZgt{}} \PY{l+m}{0}\PY{p}{)}\PY{p}{)}
         
         offline \PY{o}{=} offline\PY{p}{[} \PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}} \PY{o}{!=} \PY{k+kp}{names}\PY{p}{(}offline\PY{p}{)}\PY{p}{]}
         
         locDF \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offline\PY{p}{,} 
                      \PY{k+kp}{by}\PY{p}{(}offline\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posX\PY{p}{,} posY\PY{p}{)}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x\PY{p}{)}\PY{p}{)}
         \PY{k+kp}{length}\PY{p}{(}locDF\PY{p}{)}
         
         
         \PY{k+kp}{sum}\PY{p}{(}\PY{k+kp}{sapply}\PY{p}{(}locDF\PY{p}{,} \PY{k+kp}{is.null}\PY{p}{)}\PY{p}{)}
         
         locDF \PY{o}{=} locDF\PY{p}{[} \PY{o}{!}\PY{k+kp}{sapply}\PY{p}{(}locDF\PY{p}{,} \PY{k+kp}{is.null}\PY{p}{)} \PY{p}{]}
         
         \PY{k+kp}{length}\PY{p}{(}locDF\PY{p}{)}
         
         locCounts \PY{o}{=} \PY{k+kp}{sapply}\PY{p}{(}locDF\PY{p}{,} \PY{k+kp}{nrow}\PY{p}{)}
         
         locCounts \PY{o}{=} \PY{k+kp}{sapply}\PY{p}{(}locDF\PY{p}{,} 
                            \PY{k+kr}{function}\PY{p}{(}df\PY{p}{)} 
                              \PY{k+kt}{c}\PY{p}{(}df\PY{p}{[}\PY{l+m}{1}\PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{,} count \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}df\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{k+kp}{class}\PY{p}{(}locCounts\PY{p}{)}
         
         \PY{k+kp}{dim}\PY{p}{(}locCounts\PY{p}{)}
         
         locCounts\PY{p}{[} \PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{8}\PY{p}{]}
\end{Verbatim}


    \begin{enumerate*}
\item 12
\item 8
\end{enumerate*}


    
    
    \begin{verbatim}

00:04:0e:5c:23:fc 00:0f:a3:39:dd:cd 00:0f:a3:39:e0:4b 00:0f:a3:39:e1:c0 
              418            145619             43508            145862 
00:0f:a3:39:e2:10 00:14:bf:3b:c7:c6 00:14:bf:b1:97:81 00:14:bf:b1:97:8a 
            19162            126529            120339            132962 
00:14:bf:b1:97:8d 00:14:bf:b1:97:90 00:30:bd:f8:7f:c5 00:e0:63:82:8b:a9 
           121325            122315               301               103 
    \end{verbatim}

    
    \begin{description*}
\item[00:0f:a3:39:dd:cd] 1
\item[00:0f:a3:39:e1:c0] 1
\item[00:14:bf:3b:c7:c6] 1
\item[00:14:bf:b1:97:81] 1
\item[00:14:bf:b1:97:8a] 1
\item[00:14:bf:b1:97:8d] 1
\item[00:14:bf:b1:97:90] 1
\end{description*}


    
    476

    
    310

    
    166

    
    'matrix'

    
    \begin{enumerate*}
\item 3
\item 166
\end{enumerate*}


    
    \begin{tabular}{r|llllllll}
	posX & 0 & 1 & 2 & 0 & 1 & 2 & 0 & 1\\
	posY & 0 & 0 & 0 & 1 & 1 & 1 & 2 & 2\\
	count & 5505 & 5505 & 5506 & 5524 & 5543 & 5558 & 5503 & 5564\\
\end{tabular}


    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{10}\PY{p}{,} \PY{l+m}{7}\PY{p}{,} \PY{l+m}{5}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
         par\PY{p}{(}oldPar\PY{p}{)}
         locCounts \PY{o}{=} \PY{k+kp}{t}\PY{p}{(}locCounts\PY{p}{)}
         plot\PY{p}{(}locCounts\PY{p}{,} type \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{n\PYZdq{}}\PY{p}{,} xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{X coordinate\PYZdq{}}\PY{p}{,} ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Y coordinate\PYZdq{}}\PY{p}{,} main\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{Figure 5: Counts of Signals Detected at Each Position\PYZbs{}n (Simulated floorplan)\PYZdq{}}\PY{p}{)}
         text\PY{p}{(}locCounts\PY{p}{,} labels \PY{o}{=} locCounts\PY{p}{[}\PY{p}{,}\PY{l+m}{3}\PY{p}{]}\PY{p}{,} cex \PY{o}{=} \PY{l+m}{.8}\PY{p}{,} srt \PY{o}{=} \PY{l+m}{45}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_58_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Code for MAC Address A Data
Cleaning}\label{code-for-mac-address-a-data-cleaning}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} readData \PY{o}{=} 
           \PY{k+kr}{function}\PY{p}{(}filename \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{offline.final.trace.txt\PYZsq{}}\PY{p}{,} 
                    subMacs \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:e1:c0\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:8a\PYZdq{}}\PY{p}{,}
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:3b:c7:c6\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:90\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:8d\PYZdq{}}\PY{p}{,}
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:81\PYZdq{}}\PY{p}{)}\PY{p}{)}
           \PY{p}{\PYZob{}}
             txt \PY{o}{=} \PY{k+kp}{readLines}\PY{p}{(}filename\PY{p}{)}
             lines \PY{o}{=} txt\PY{p}{[} \PY{k+kp}{substr}\PY{p}{(}txt\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)} \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}\PYZdq{}} \PY{p}{]}
             tmp \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}lines\PY{p}{,} processLine\PY{p}{)}
             offline0 \PY{o}{=} \PY{k+kp}{as.data.frame}\PY{p}{(}\PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} tmp\PY{p}{)}\PY{p}{,} 
                                     stringsAsFactors\PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)} 
             
             \PY{k+kp}{names}\PY{p}{(}offline0\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} 
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} 
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{mac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}}\PY{p}{)}
             
              \PY{c+c1}{\PYZsh{} keep only signals from access points}
             offline0 \PY{o}{=} offline0\PY{p}{[} offline0\PY{o}{\PYZdl{}}type \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{3\PYZdq{}}\PY{p}{,} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} drop scanMac, posZ, channel, and type \PYZhy{} no info in them}
             dropVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}}\PY{p}{)}
             offline0 \PY{o}{=} offline0\PY{p}{[} \PY{p}{,} \PY{o}{!}\PY{p}{(} \PY{k+kp}{names}\PY{p}{(}offline0\PY{p}{)} \PY{o}{\PYZpc{}in\PYZpc{}} dropVars \PY{p}{)} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} drop more unwanted access points}
             offline0 \PY{o}{=} offline0\PY{p}{[} offline0\PY{o}{\PYZdl{}}mac \PY{o}{\PYZpc{}in\PYZpc{}} subMacs\PY{p}{,} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} convert numeric values}
             numVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{)}
             offline0\PY{p}{[} numVars \PY{p}{]} \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}offline0\PY{p}{[} numVars \PY{p}{]}\PY{p}{,} \PY{k+kp}{as.numeric}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} convert time to POSIX}
             offline0\PY{o}{\PYZdl{}}rawTime \PY{o}{=} offline0\PY{o}{\PYZdl{}}time
             offline0\PY{o}{\PYZdl{}}time \PY{o}{=} offline0\PY{o}{\PYZdl{}}time\PY{o}{/}\PY{l+m}{1000}
             \PY{k+kp}{class}\PY{p}{(}offline0\PY{o}{\PYZdl{}}time\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXt\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXct\PYZdq{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} round orientations to nearest 45}
             offline0\PY{o}{\PYZdl{}}angle \PY{o}{=} roundOrientation\PY{p}{(}offline0\PY{o}{\PYZdl{}}orientation\PY{p}{)}
               
             \PY{k+kr}{return}\PY{p}{(}offline0\PY{p}{)}
           \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} offlineRedo \PY{o}{=} readData\PY{p}{(}\PY{p}{)}
         macChannel0 \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offlineRedo\PY{p}{,} \PY{k+kp}{table}\PY{p}{(}mac\PY{p}{)}\PY{p}{)}
         \PY{k+kp}{apply}\PY{p}{(}macChannel0\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sum}\PY{p}{(}x \PY{o}{\PYZgt{}} \PY{l+m}{0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{description*}
\item[00:0f:a3:39:e1:c0] 1
\item[00:14:bf:3b:c7:c6] 1
\item[00:14:bf:b1:97:81] 1
\item[00:14:bf:b1:97:8a] 1
\item[00:14:bf:b1:97:8d] 1
\item[00:14:bf:b1:97:90] 1
\end{description*}


    
    \subsubsection{Code for MAC Address A
Predictions}\label{code-for-mac-address-a-predictions}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} macs \PY{o}{=} \PY{k+kp}{unique}\PY{p}{(}offlineSummaryRedo\PY{o}{\PYZdl{}}mac\PY{p}{)}
         online \PY{o}{=} readData\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{online.final.trace.txt\PYZdq{}}\PY{p}{,} subMacs \PY{o}{=} macs\PY{p}{)}
         
         online\PY{o}{\PYZdl{}}posXY \PY{o}{=} \PY{k+kp}{paste}\PY{p}{(}online\PY{o}{\PYZdl{}}posX\PY{p}{,} online\PY{o}{\PYZdl{}}posY\PY{p}{,} sep \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}\PYZdq{}}\PY{p}{)}
         
         \PY{k+kp}{length}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}online\PY{o}{\PYZdl{}}posXY\PY{p}{)}\PY{p}{)}
         
         tabonlineXYA \PY{o}{=} \PY{k+kp}{table}\PY{p}{(}online\PY{o}{\PYZdl{}}posXY\PY{p}{,} online\PY{o}{\PYZdl{}}angle\PY{p}{)}
         tabonlineXYA\PY{p}{[}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{6}\PY{p}{,} \PY{p}{]}
         
         keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{angle\PYZdq{}}\PY{p}{)}
         byLoc \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}online\PY{p}{,} 
                      \PY{k+kp}{by}\PY{p}{(}online\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{)}\PY{p}{,} 
                         \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{p}{\PYZob{}}
                           ans \PY{o}{=} x\PY{p}{[}\PY{l+m}{1}\PY{p}{,} keepVars\PY{p}{]}
                           avgSS \PY{o}{=} \PY{k+kp}{tapply}\PY{p}{(}x\PY{o}{\PYZdl{}}signal\PY{p}{,} x\PY{o}{\PYZdl{}}mac\PY{p}{,} \PY{k+kp}{mean}\PY{p}{)}
                           y \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}avgSS\PY{p}{,} nrow \PY{o}{=} \PY{l+m}{1}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{6}\PY{p}{,}
                                 dimnames \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}ans\PY{o}{\PYZdl{}}posXY\PY{p}{,} \PY{k+kp}{names}\PY{p}{(}avgSS\PY{p}{)}\PY{p}{)}\PY{p}{)}
                           \PY{k+kp}{cbind}\PY{p}{(}ans\PY{p}{,} y\PY{p}{)}
                         \PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{)}
         
         onlineSummaryRedo \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} byLoc\PY{p}{)}  
         
         \PY{k+kp}{dim}\PY{p}{(}onlineSummaryRedo\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        Error in unique(offlineSummaryRedo\$mac): object 'offlineSummaryRedo' not found
    Traceback:
    

        1. unique(offlineSummaryRedo\$mac)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kp}{names}\PY{p}{(}onlineSummaryRedo\PY{p}{)}
        m \PY{o}{=} \PY{l+m}{3}\PY{p}{;} angleNewObs \PY{o}{=} \PY{l+m}{230}
        refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{,} length  \PY{o}{=} \PY{l+m}{8}\PY{p}{)}
        nearestAngle \PY{o}{=} roundOrientation\PY{p}{(}angleNewObs\PY{p}{)}
          
        \PY{k+kr}{if} \PY{p}{(}m \PY{o}{\PYZpc{}\PYZpc{}} \PY{l+m}{2} \PY{o}{==} \PY{l+m}{1}\PY{p}{)} \PY{p}{\PYZob{}}
          angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
        \PY{p}{\PYZcb{}} \PY{k+kr}{else} \PY{p}{\PYZob{}}
          m \PY{o}{=} m \PY{o}{+} \PY{l+m}{1}
          angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
          \PY{k+kr}{if} \PY{p}{(}\PY{k+kp}{sign}\PY{p}{(}angleNewObs \PY{o}{\PYZhy{}} nearestAngle\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m}{\PYZhy{}1}\PY{p}{)} 
            angles \PY{o}{=} angles\PY{p}{[} \PY{l+m}{\PYZhy{}1} \PY{p}{]}
          \PY{k+kr}{else} 
            angles \PY{o}{=} angles\PY{p}{[} \PY{o}{\PYZhy{}}m \PY{p}{]}
        \PY{p}{\PYZcb{}}
        angles \PY{o}{=} angles \PY{o}{+} nearestAngle
        angles\PY{p}{[}angles \PY{o}{\PYZlt{}} \PY{l+m}{0}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZlt{}} \PY{l+m}{0} \PY{p}{]} \PY{o}{+} \PY{l+m}{360}
        angles\PY{p}{[}angles \PY{o}{\PYZgt{}} \PY{l+m}{360}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZgt{}} \PY{l+m}{360} \PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m}{360}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} offlineSubset \PY{o}{=} 
          offlineSummaryRedo\PY{p}{[} offlineSummaryRedo\PY{o}{\PYZdl{}}angle \PY{o}{\PYZpc{}in\PYZpc{}} angles\PY{p}{,} \PY{p}{]}
        
        reshapeSS \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}data\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} 
                             keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
          byLocation \PY{o}{=}
            \PY{k+kp}{with}\PY{p}{(}data\PY{p}{,} \PY{k+kp}{by}\PY{p}{(}data\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{)}\PY{p}{,} 
                          \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{p}{\PYZob{}}
                            ans \PY{o}{=} x\PY{p}{[}\PY{l+m}{1}\PY{p}{,} keepVars\PY{p}{]}
                            avgSS \PY{o}{=} \PY{k+kp}{tapply}\PY{p}{(}x\PY{p}{[} \PY{p}{,} varSignal \PY{p}{]}\PY{p}{,} x\PY{o}{\PYZdl{}}mac\PY{p}{,} \PY{k+kp}{mean}\PY{p}{)}
                            y \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}avgSS\PY{p}{,} nrow \PY{o}{=} \PY{l+m}{1}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{6}\PY{p}{,}
                                       dimnames \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}ans\PY{o}{\PYZdl{}}posXY\PY{p}{,}
                                                       \PY{k+kp}{names}\PY{p}{(}avgSS\PY{p}{)}\PY{p}{)}\PY{p}{)}
                            \PY{k+kp}{cbind}\PY{p}{(}ans\PY{p}{,} y\PY{p}{)}
                          \PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{)}
        
          newDataSS \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} byLocation\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}newDataSS\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} trainSS \PY{o}{=} reshapeSS\PY{p}{(}offlineSubset\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{avgSignal\PYZdq{}}\PY{p}{)}
        
        selectTrain \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}angleNewObs\PY{p}{,} signals \PY{o}{=} \PY{k+kc}{NULL}\PY{p}{,} m \PY{o}{=} \PY{l+m}{1}\PY{p}{)}\PY{p}{\PYZob{}}
          \PY{c+c1}{\PYZsh{} m is the number of angles to keep between 1 and 5}
          refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{,} length  \PY{o}{=} \PY{l+m}{8}\PY{p}{)}
          nearestAngle \PY{o}{=} roundOrientation\PY{p}{(}angleNewObs\PY{p}{)}
          
          \PY{k+kr}{if} \PY{p}{(}m \PY{o}{\PYZpc{}\PYZpc{}} \PY{l+m}{2} \PY{o}{==} \PY{l+m}{1}\PY{p}{)} 
            angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
          \PY{k+kr}{else} \PY{p}{\PYZob{}}
            m \PY{o}{=} m \PY{o}{+} \PY{l+m}{1}
            angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
            \PY{k+kr}{if} \PY{p}{(}\PY{k+kp}{sign}\PY{p}{(}angleNewObs \PY{o}{\PYZhy{}} nearestAngle\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m}{\PYZhy{}1}\PY{p}{)} 
              angles \PY{o}{=} angles\PY{p}{[} \PY{l+m}{\PYZhy{}1} \PY{p}{]}
            \PY{k+kr}{else} 
              angles \PY{o}{=} angles\PY{p}{[} \PY{o}{\PYZhy{}}m \PY{p}{]}
          \PY{p}{\PYZcb{}}
          angles \PY{o}{=} angles \PY{o}{+} nearestAngle
          angles\PY{p}{[}angles \PY{o}{\PYZlt{}} \PY{l+m}{0}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZlt{}} \PY{l+m}{0} \PY{p}{]} \PY{o}{+} \PY{l+m}{360}
          angles\PY{p}{[}angles \PY{o}{\PYZgt{}} \PY{l+m}{360}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZgt{}} \PY{l+m}{360} \PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m}{360}
          angles \PY{o}{=} \PY{k+kp}{sort}\PY{p}{(}angles\PY{p}{)} 
          
          offlineSubset \PY{o}{=} signals\PY{p}{[} signals\PY{o}{\PYZdl{}}angle \PY{o}{\PYZpc{}in\PYZpc{}} angles\PY{p}{,} \PY{p}{]}
          reshapeSS\PY{p}{(}offlineSubset\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{avgSignal\PYZdq{}}\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} train130 \PY{o}{=} selectTrain\PY{p}{(}\PY{l+m}{130}\PY{p}{,} offlineSummaryRedo\PY{p}{,} m \PY{o}{=} \PY{l+m}{3}\PY{p}{)}
        
        \PY{k+kp}{head}\PY{p}{(}train130\PY{p}{)}
        
        \PY{k+kp}{length}\PY{p}{(}train130\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}\PY{p}{)}
        
        findNN \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignal\PY{p}{,} trainSubset\PY{p}{)} \PY{p}{\PYZob{}}
          diffs \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}trainSubset\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{o}{:}\PY{l+m}{9}\PY{p}{]}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} 
                        \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x \PY{o}{\PYZhy{}} newSignal\PY{p}{)}
          dists \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}diffs\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sqrt}\PY{p}{(}\PY{k+kp}{sum}\PY{p}{(}x\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)}\PY{p}{)} \PY{p}{)}
          closest \PY{o}{=} \PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}trainSubset\PY{p}{[}closest\PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{3} \PY{p}{]}\PY{p}{)}
        \PY{p}{\PYZcb{}}
        
        findNN2 \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignal\PY{p}{,} trainSubset\PY{p}{)} \PY{p}{\PYZob{}}
          diffs \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}trainSubset\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{o}{:}\PY{l+m}{9}\PY{p}{]}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} 
                        \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x \PY{o}{\PYZhy{}} newSignal\PY{p}{)}
          dists \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}diffs\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sqrt}\PY{p}{(}\PY{k+kp}{sum}\PY{p}{(}x\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)}\PY{p}{)} \PY{p}{)}
          closest \PY{o}{=} \PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}\PY{k+kt}{list}\PY{p}{(}trainSubset\PY{p}{[}closest\PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{3} \PY{p}{]}\PY{p}{,}dists\PY{p}{[}\PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} predXY \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignals\PY{p}{,} newAngles\PY{p}{,} trainData\PY{p}{,} 
                          numAngles \PY{o}{=} \PY{l+m}{1}\PY{p}{,} k \PY{o}{=} \PY{l+m}{3}\PY{p}{)}\PY{p}{\PYZob{}}
          
          closeXY \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
            trainSS \PY{o}{=} selectTrain\PY{p}{(}newAngles\PY{p}{[}i\PY{p}{]}\PY{p}{,} trainData\PY{p}{,} m \PY{o}{=} numAngles\PY{p}{)}
            closeXY\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} 
              findNN\PY{p}{(}newSignal \PY{o}{=} \PY{k+kp}{as.numeric}\PY{p}{(}newSignals\PY{p}{[}i\PY{p}{,} \PY{p}{]}\PY{p}{)}\PY{p}{,} trainSS\PY{p}{)}
          \PY{p}{\PYZcb{}}
        
          estXY \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}closeXY\PY{p}{,} 
                         \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sapply}\PY{p}{(}x\PY{p}{[} \PY{p}{,} \PY{l+m}{2}\PY{o}{:}\PY{l+m}{3}\PY{p}{]}\PY{p}{,} 
                                            \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{mean}\PY{p}{(}x\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          estXY \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} estXY\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}estXY\PY{p}{)}
        \PY{p}{\PYZcb{}}
        estXYkRedo \PY{o}{=} predXY\PY{p}{(}newSignals \PY{o}{=} onlineSummaryRedo\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{11}\PY{p}{]}\PY{p}{,} 
                         newAngles \PY{o}{=} onlineSummaryRedo\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                         offlineSummaryRedo\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} \PY{l+m}{6}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}estXYkRedo}
\end{Verbatim}


    \subsubsection{MAC Address A Alternative Location
Methodology}\label{mac-address-a-alternative-location-methodology}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{c+c1}{\PYZsh{}Modify findNN to utilize distance output for estimation efforts}
         predXYaltredo \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignals\PY{p}{,} newAngles\PY{p}{,} trainData\PY{p}{,} 
                           numAngles \PY{o}{=} \PY{l+m}{1}\PY{p}{,} k \PY{o}{=} \PY{l+m}{3}\PY{p}{)}\PY{p}{\PYZob{}}
           
           closeXY \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
           closeDist \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
           
           \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
             trainSS \PY{o}{=} selectTrain\PY{p}{(}newAngles\PY{p}{[}i\PY{p}{]}\PY{p}{,} trainData\PY{p}{,} m \PY{o}{=} numAngles\PY{p}{)}
             fnnResult \PY{o}{=}
             findNN2\PY{p}{(}newSignal \PY{o}{=} \PY{k+kp}{as.numeric}\PY{p}{(}newSignals\PY{p}{[}i\PY{p}{,} \PY{p}{]}\PY{p}{)}\PY{p}{,} trainSS\PY{p}{)}
           
             closeXY\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} fnnResult\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}
             closeDist\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} fnnResult\PY{p}{[[}\PY{l+m}{2}\PY{p}{]]}
           \PY{p}{\PYZcb{}}
           
           distWeight \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{length}\PY{p}{(}closeDist\PY{p}{)}\PY{p}{)}
           
           \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{length}\PY{p}{(}closeDist\PY{p}{)}\PY{p}{)}\PY{p}{\PYZob{}}
             distW \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} k\PY{p}{)}
         
             \PY{k+kr}{for} \PY{p}{(}j \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}k\PY{p}{)}\PY{p}{\PYZob{}}
               distW\PY{p}{[}j\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m}{1}\PY{o}{/}closeDist\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}j\PY{p}{]}\PY{p}{)}\PY{o}{/}\PY{k+kp}{sum}\PY{p}{(}\PY{l+m}{1}\PY{o}{/}closeDist\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{]}\PY{p}{)}
             \PY{p}{\PYZcb{}}
              
             distWeight\PY{p}{[[}i\PY{p}{]]} \PY{o}{=}  distW
           \PY{p}{\PYZcb{}}
         
           estXYDetails \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length\PY{o}{=}\PY{k+kp}{length}\PY{p}{(}closeXY\PY{p}{)}\PY{p}{)}
           
           \PY{k+kr}{for}\PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{length}\PY{p}{(}closeXY\PY{p}{)}\PY{p}{)}\PY{p}{\PYZob{}}
             estXYDetails\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} \PY{k+kp}{as.matrix}\PY{p}{(}closeXY\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{,}\PY{l+m}{2}\PY{o}{:}\PY{l+m}{3}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{k+kp}{unlist}\PY{p}{(}distWeight\PY{p}{[[}i\PY{p}{]]}\PY{p}{)}
           \PY{p}{\PYZcb{}}
           
           estXY \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}estXYDetails\PY{p}{,}
                          \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{apply}\PY{p}{(}x\PY{p}{,} \PY{l+m}{2}\PY{p}{,}
                                            \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sum}\PY{p}{(}x\PY{p}{)}\PY{p}{)}\PY{p}{)}
             
           estXY \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} estXY\PY{p}{)}
           \PY{k+kr}{return}\PY{p}{(}estXY\PY{p}{)}
         \PY{p}{\PYZcb{}}
                                            
         estXYkRedoalt \PY{o}{=} predXYaltredo\PY{p}{(}newSignals \PY{o}{=} onlineSummaryRedo\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{11}\PY{p}{]}\PY{p}{,} 
                          newAngles \PY{o}{=} onlineSummaryRedo\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                          offlineSummaryRedo\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} \PY{l+m}{6}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        Error in nrow(newSignals): object 'onlineSummaryRedo' not found
    Traceback:
    

        1. predXYaltredo(newSignals = onlineSummaryRedo[, 6:11], newAngles = onlineSummaryRedo[, 
     .     4], offlineSummaryRedo, numAngles = 3, k = 6)

        2. nrow(newSignals)   \# at line 5 of file <text>

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} calcError \PY{o}{=} 
        \PY{k+kr}{function}\PY{p}{(}estXY\PY{p}{,} actualXY\PY{p}{)} 
           \PY{k+kp}{sum}\PY{p}{(} \PY{k+kp}{rowSums}\PY{p}{(} \PY{p}{(}estXY \PY{o}{\PYZhy{}} actualXY\PY{p}{)}\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)} \PY{p}{)}
        
        actualXYRedo \PY{o}{=} onlineSummaryRedo\PY{p}{[} \PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{]}
        \PY{k+kp}{sapply}\PY{p}{(}\PY{k+kt}{list}\PY{p}{(}estXYkRedo\PY{p}{,}estXYkRedoalt\PY{p}{)}\PY{p}{,} calcError\PY{p}{,} actualXYRedo\PY{p}{)}
\end{Verbatim}


    \subsubsection{Code for MAC Address B Data
Cleaning}\label{code-for-mac-address-b-data-cleaning}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} readDataNew \PY{o}{=} 
           \PY{k+kr}{function}\PY{p}{(}filename \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{offline.final.trace.txt\PYZsq{}}\PY{p}{,} 
                    subMacs \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:8a\PYZdq{}}\PY{p}{,}
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:3b:c7:c6\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:90\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:8d\PYZdq{}}\PY{p}{,}
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:81\PYZdq{}}\PY{p}{)}\PY{p}{)}
           \PY{p}{\PYZob{}}
             txt \PY{o}{=} \PY{k+kp}{readLines}\PY{p}{(}filename\PY{p}{)}
             lines \PY{o}{=} txt\PY{p}{[} \PY{k+kp}{substr}\PY{p}{(}txt\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)} \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}\PYZdq{}} \PY{p}{]}
             tmp \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}lines\PY{p}{,} processLine\PY{p}{)}
             offline1 \PY{o}{=} \PY{k+kp}{as.data.frame}\PY{p}{(}\PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} tmp\PY{p}{)}\PY{p}{,} 
                                     stringsAsFactors\PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)} 
             
             \PY{k+kp}{names}\PY{p}{(}offline1\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} 
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} 
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{mac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}}\PY{p}{)}
             
              \PY{c+c1}{\PYZsh{} keep only signals from access points}
             offline1 \PY{o}{=} offline1\PY{p}{[} offline1\PY{o}{\PYZdl{}}type \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{3\PYZdq{}}\PY{p}{,} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} drop scanMac, posZ, channel, and type \PYZhy{} no info in them}
             dropVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}}\PY{p}{)}
             offline1 \PY{o}{=} offline1\PY{p}{[} \PY{p}{,} \PY{o}{!}\PY{p}{(} \PY{k+kp}{names}\PY{p}{(}offline1\PY{p}{)} \PY{o}{\PYZpc{}in\PYZpc{}} dropVars \PY{p}{)} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} drop more unwanted access points}
             offline1 \PY{o}{=} offline1\PY{p}{[} offline1\PY{o}{\PYZdl{}}mac \PY{o}{\PYZpc{}in\PYZpc{}} subMacs\PY{p}{,} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} convert numeric values}
             numVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{)}
             offline1\PY{p}{[} numVars \PY{p}{]} \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}offline1\PY{p}{[} numVars \PY{p}{]}\PY{p}{,} \PY{k+kp}{as.numeric}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} convert time to POSIX}
             offline1\PY{o}{\PYZdl{}}rawTime \PY{o}{=} offline1\PY{o}{\PYZdl{}}time
             offline1\PY{o}{\PYZdl{}}time \PY{o}{=} offline1\PY{o}{\PYZdl{}}time\PY{o}{/}\PY{l+m}{1000}
             \PY{k+kp}{class}\PY{p}{(}offline1\PY{o}{\PYZdl{}}time\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXt\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXct\PYZdq{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} round orientations to nearest 45}
             offline1\PY{o}{\PYZdl{}}angle \PY{o}{=} roundOrientation\PY{p}{(}offline1\PY{o}{\PYZdl{}}orientation\PY{p}{)}
               
             \PY{k+kr}{return}\PY{p}{(}offline1\PY{p}{)}
           \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} offlinenew \PY{o}{=} readDataNew\PY{p}{(}\PY{p}{)}
         macChannel1 \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offlinenew\PY{p}{,} \PY{k+kp}{table}\PY{p}{(}mac\PY{p}{)}\PY{p}{)}
         \PY{k+kp}{apply}\PY{p}{(}macChannel1\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sum}\PY{p}{(}x \PY{o}{\PYZgt{}} \PY{l+m}{0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{description*}
\item[00:0f:a3:39:dd:cd] 1
\item[00:14:bf:3b:c7:c6] 1
\item[00:14:bf:b1:97:81] 1
\item[00:14:bf:b1:97:8a] 1
\item[00:14:bf:b1:97:8d] 1
\item[00:14:bf:b1:97:90] 1
\end{description*}


    
    \subsubsection{Code for MAC Address B
Predictions}\label{code-for-mac-address-b-predictions}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} macs \PY{o}{=} \PY{k+kp}{unique}\PY{p}{(}offlineSummarynew\PY{o}{\PYZdl{}}mac\PY{p}{)}
         online \PY{o}{=} readData\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{online.final.trace.txt\PYZdq{}}\PY{p}{,} subMacs \PY{o}{=} macs\PY{p}{)}
         
         online\PY{o}{\PYZdl{}}posXY \PY{o}{=} \PY{k+kp}{paste}\PY{p}{(}online\PY{o}{\PYZdl{}}posX\PY{p}{,} online\PY{o}{\PYZdl{}}posY\PY{p}{,} sep \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}\PYZdq{}}\PY{p}{)}
         
         \PY{k+kp}{length}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}online\PY{o}{\PYZdl{}}posXY\PY{p}{)}\PY{p}{)}
         
         tabonlineXYA \PY{o}{=} \PY{k+kp}{table}\PY{p}{(}online\PY{o}{\PYZdl{}}posXY\PY{p}{,} online\PY{o}{\PYZdl{}}angle\PY{p}{)}
         tabonlineXYA\PY{p}{[}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{6}\PY{p}{,} \PY{p}{]}
         
         keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{angle\PYZdq{}}\PY{p}{)}
         byLoc \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}online\PY{p}{,} 
                      \PY{k+kp}{by}\PY{p}{(}online\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{)}\PY{p}{,} 
                         \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{p}{\PYZob{}}
                           ans \PY{o}{=} x\PY{p}{[}\PY{l+m}{1}\PY{p}{,} keepVars\PY{p}{]}
                           avgSS \PY{o}{=} \PY{k+kp}{tapply}\PY{p}{(}x\PY{o}{\PYZdl{}}signal\PY{p}{,} x\PY{o}{\PYZdl{}}mac\PY{p}{,} \PY{k+kp}{mean}\PY{p}{)}
                           y \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}avgSS\PY{p}{,} nrow \PY{o}{=} \PY{l+m}{1}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{6}\PY{p}{,}
                                 dimnames \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}ans\PY{o}{\PYZdl{}}posXY\PY{p}{,} \PY{k+kp}{names}\PY{p}{(}avgSS\PY{p}{)}\PY{p}{)}\PY{p}{)}
                           \PY{k+kp}{cbind}\PY{p}{(}ans\PY{p}{,} y\PY{p}{)}
                         \PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{)}
         
         onlineSummarynew \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} byLoc\PY{p}{)}  
         
         \PY{k+kp}{dim}\PY{p}{(}onlineSummarynew\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        Error in unique(offlineSummarynew\$mac): object 'offlineSummarynew' not found
    Traceback:
    

        1. unique(offlineSummarynew\$mac)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kp}{names}\PY{p}{(}onlineSummarynew\PY{p}{)}
        m \PY{o}{=} \PY{l+m}{3}\PY{p}{;} angleNewObs \PY{o}{=} \PY{l+m}{230}
        refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{,} length  \PY{o}{=} \PY{l+m}{8}\PY{p}{)}
        nearestAngle \PY{o}{=} roundOrientation\PY{p}{(}angleNewObs\PY{p}{)}
          
        \PY{k+kr}{if} \PY{p}{(}m \PY{o}{\PYZpc{}\PYZpc{}} \PY{l+m}{2} \PY{o}{==} \PY{l+m}{1}\PY{p}{)} \PY{p}{\PYZob{}}
          angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
        \PY{p}{\PYZcb{}} \PY{k+kr}{else} \PY{p}{\PYZob{}}
          m \PY{o}{=} m \PY{o}{+} \PY{l+m}{1}
          angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
          \PY{k+kr}{if} \PY{p}{(}\PY{k+kp}{sign}\PY{p}{(}angleNewObs \PY{o}{\PYZhy{}} nearestAngle\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m}{\PYZhy{}1}\PY{p}{)} 
            angles \PY{o}{=} angles\PY{p}{[} \PY{l+m}{\PYZhy{}1} \PY{p}{]}
          \PY{k+kr}{else} 
            angles \PY{o}{=} angles\PY{p}{[} \PY{o}{\PYZhy{}}m \PY{p}{]}
        \PY{p}{\PYZcb{}}
        angles \PY{o}{=} angles \PY{o}{+} nearestAngle
        angles\PY{p}{[}angles \PY{o}{\PYZlt{}} \PY{l+m}{0}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZlt{}} \PY{l+m}{0} \PY{p}{]} \PY{o}{+} \PY{l+m}{360}
        angles\PY{p}{[}angles \PY{o}{\PYZgt{}} \PY{l+m}{360}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZgt{}} \PY{l+m}{360} \PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m}{360}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} offlineSubset \PY{o}{=} 
          offlineSummarynew\PY{p}{[} offlineSummarynew\PY{o}{\PYZdl{}}angle \PY{o}{\PYZpc{}in\PYZpc{}} angles\PY{p}{,} \PY{p}{]}
        
        reshapeSS \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}data\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} 
                             keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
          byLocation \PY{o}{=}
            \PY{k+kp}{with}\PY{p}{(}data\PY{p}{,} \PY{k+kp}{by}\PY{p}{(}data\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{)}\PY{p}{,} 
                          \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{p}{\PYZob{}}
                            ans \PY{o}{=} x\PY{p}{[}\PY{l+m}{1}\PY{p}{,} keepVars\PY{p}{]}
                            avgSS \PY{o}{=} \PY{k+kp}{tapply}\PY{p}{(}x\PY{p}{[} \PY{p}{,} varSignal \PY{p}{]}\PY{p}{,} x\PY{o}{\PYZdl{}}mac\PY{p}{,} \PY{k+kp}{mean}\PY{p}{)}
                            y \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}avgSS\PY{p}{,} nrow \PY{o}{=} \PY{l+m}{1}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{6}\PY{p}{,}
                                       dimnames \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}ans\PY{o}{\PYZdl{}}posXY\PY{p}{,}
                                                       \PY{k+kp}{names}\PY{p}{(}avgSS\PY{p}{)}\PY{p}{)}\PY{p}{)}
                            \PY{k+kp}{cbind}\PY{p}{(}ans\PY{p}{,} y\PY{p}{)}
                          \PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{)}
        
          newDataSS \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} byLocation\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}newDataSS\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} trainSS \PY{o}{=} reshapeSS\PY{p}{(}offlineSubset\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{avgSignal\PYZdq{}}\PY{p}{)}
        
        selectTrain \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}angleNewObs\PY{p}{,} signals \PY{o}{=} \PY{k+kc}{NULL}\PY{p}{,} m \PY{o}{=} \PY{l+m}{1}\PY{p}{)}\PY{p}{\PYZob{}}
          \PY{c+c1}{\PYZsh{} m is the number of angles to keep between 1 and 5}
          refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{,} length  \PY{o}{=} \PY{l+m}{8}\PY{p}{)}
          nearestAngle \PY{o}{=} roundOrientation\PY{p}{(}angleNewObs\PY{p}{)}
          
          \PY{k+kr}{if} \PY{p}{(}m \PY{o}{\PYZpc{}\PYZpc{}} \PY{l+m}{2} \PY{o}{==} \PY{l+m}{1}\PY{p}{)} 
            angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
          \PY{k+kr}{else} \PY{p}{\PYZob{}}
            m \PY{o}{=} m \PY{o}{+} \PY{l+m}{1}
            angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
            \PY{k+kr}{if} \PY{p}{(}\PY{k+kp}{sign}\PY{p}{(}angleNewObs \PY{o}{\PYZhy{}} nearestAngle\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m}{\PYZhy{}1}\PY{p}{)} 
              angles \PY{o}{=} angles\PY{p}{[} \PY{l+m}{\PYZhy{}1} \PY{p}{]}
            \PY{k+kr}{else} 
              angles \PY{o}{=} angles\PY{p}{[} \PY{o}{\PYZhy{}}m \PY{p}{]}
          \PY{p}{\PYZcb{}}
          angles \PY{o}{=} angles \PY{o}{+} nearestAngle
          angles\PY{p}{[}angles \PY{o}{\PYZlt{}} \PY{l+m}{0}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZlt{}} \PY{l+m}{0} \PY{p}{]} \PY{o}{+} \PY{l+m}{360}
          angles\PY{p}{[}angles \PY{o}{\PYZgt{}} \PY{l+m}{360}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZgt{}} \PY{l+m}{360} \PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m}{360}
          angles \PY{o}{=} \PY{k+kp}{sort}\PY{p}{(}angles\PY{p}{)} 
          
          offlineSubset \PY{o}{=} signals\PY{p}{[} signals\PY{o}{\PYZdl{}}angle \PY{o}{\PYZpc{}in\PYZpc{}} angles\PY{p}{,} \PY{p}{]}
          reshapeSS\PY{p}{(}offlineSubset\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{avgSignal\PYZdq{}}\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} train130 \PY{o}{=} selectTrain\PY{p}{(}\PY{l+m}{130}\PY{p}{,} offlineSummarynew\PY{p}{,} m \PY{o}{=} \PY{l+m}{3}\PY{p}{)}
        
        \PY{k+kp}{head}\PY{p}{(}train130\PY{p}{)} 
        
        \PY{k+kp}{length}\PY{p}{(}train130\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}\PY{p}{)}
        
        findNN \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignal\PY{p}{,} trainSubset\PY{p}{)} \PY{p}{\PYZob{}}
          diffs \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}trainSubset\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{o}{:}\PY{l+m}{9}\PY{p}{]}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} 
                        \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x \PY{o}{\PYZhy{}} newSignal\PY{p}{)}
          dists \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}diffs\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sqrt}\PY{p}{(}\PY{k+kp}{sum}\PY{p}{(}x\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)}\PY{p}{)} \PY{p}{)}
          closest \PY{o}{=} \PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}trainSubset\PY{p}{[}closest\PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{3} \PY{p}{]}\PY{p}{)}
        \PY{p}{\PYZcb{}}
        
        findNN2 \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignal\PY{p}{,} trainSubset\PY{p}{)} \PY{p}{\PYZob{}}
          diffs \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}trainSubset\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{o}{:}\PY{l+m}{9}\PY{p}{]}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} 
                        \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x \PY{o}{\PYZhy{}} newSignal\PY{p}{)}
          dists \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}diffs\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sqrt}\PY{p}{(}\PY{k+kp}{sum}\PY{p}{(}x\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)}\PY{p}{)} \PY{p}{)}
          closest \PY{o}{=} \PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}\PY{k+kt}{list}\PY{p}{(}trainSubset\PY{p}{[}closest\PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{3} \PY{p}{]}\PY{p}{,}dists\PY{p}{[}\PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} predXY \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignals\PY{p}{,} newAngles\PY{p}{,} trainData\PY{p}{,} 
                          numAngles \PY{o}{=} \PY{l+m}{1}\PY{p}{,} k \PY{o}{=} \PY{l+m}{3}\PY{p}{)}\PY{p}{\PYZob{}}
          
          closeXY \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
            trainSS \PY{o}{=} selectTrain\PY{p}{(}newAngles\PY{p}{[}i\PY{p}{]}\PY{p}{,} trainData\PY{p}{,} m \PY{o}{=} numAngles\PY{p}{)}
            closeXY\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} 
              findNN\PY{p}{(}newSignal \PY{o}{=} \PY{k+kp}{as.numeric}\PY{p}{(}newSignals\PY{p}{[}i\PY{p}{,} \PY{p}{]}\PY{p}{)}\PY{p}{,} trainSS\PY{p}{)}
          \PY{p}{\PYZcb{}}
        
          estXY \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}closeXY\PY{p}{,} 
                         \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sapply}\PY{p}{(}x\PY{p}{[} \PY{p}{,} \PY{l+m}{2}\PY{o}{:}\PY{l+m}{3}\PY{p}{]}\PY{p}{,} 
                                            \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{mean}\PY{p}{(}x\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          estXY \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} estXY\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}estXY\PY{p}{)}
        \PY{p}{\PYZcb{}}
        estXYknew \PY{o}{=} predXY\PY{p}{(}newSignals \PY{o}{=} onlineSummarynew\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{11}\PY{p}{]}\PY{p}{,} 
                         newAngles \PY{o}{=} onlineSummarynew\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                         offlineSummarynew\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} \PY{l+m}{6}\PY{p}{)}
\end{Verbatim}


    \subsubsection{MAC Address B Alternative Location
Methodology}\label{mac-address-b-alternative-location-methodology}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}Modify findNN to utilize distance output for estimation efforts}
        predXYalt \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignals\PY{p}{,} newAngles\PY{p}{,} trainData\PY{p}{,} 
                          numAngles \PY{o}{=} \PY{l+m}{1}\PY{p}{,} k \PY{o}{=} \PY{l+m}{3}\PY{p}{)}\PY{p}{\PYZob{}}
          
          closeXY \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
          closeDist \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
            trainSS \PY{o}{=} selectTrain\PY{p}{(}newAngles\PY{p}{[}i\PY{p}{]}\PY{p}{,} trainData\PY{p}{,} m \PY{o}{=} numAngles\PY{p}{)}
            fnnResult \PY{o}{=}
            findNN2\PY{p}{(}newSignal \PY{o}{=} \PY{k+kp}{as.numeric}\PY{p}{(}newSignals\PY{p}{[}i\PY{p}{,} \PY{p}{]}\PY{p}{)}\PY{p}{,} trainSS\PY{p}{)}
          
            closeXY\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} fnnResult\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}
            closeDist\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} fnnResult\PY{p}{[[}\PY{l+m}{2}\PY{p}{]]}
          \PY{p}{\PYZcb{}}
          
          distWeight \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{length}\PY{p}{(}closeDist\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{length}\PY{p}{(}closeDist\PY{p}{)}\PY{p}{)}\PY{p}{\PYZob{}}
            distW \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} k\PY{p}{)}
        
            \PY{k+kr}{for} \PY{p}{(}j \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}k\PY{p}{)}\PY{p}{\PYZob{}}
              distW\PY{p}{[}j\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m}{1}\PY{o}{/}closeDist\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}j\PY{p}{]}\PY{p}{)}\PY{o}{/}\PY{k+kp}{sum}\PY{p}{(}\PY{l+m}{1}\PY{o}{/}closeDist\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{]}\PY{p}{)}
            \PY{p}{\PYZcb{}}
             
            distWeight\PY{p}{[[}i\PY{p}{]]} \PY{o}{=}  distW
          \PY{p}{\PYZcb{}}
        
          estXYDetails \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length\PY{o}{=}\PY{k+kp}{length}\PY{p}{(}closeXY\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for}\PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{length}\PY{p}{(}closeXY\PY{p}{)}\PY{p}{)}\PY{p}{\PYZob{}}
            estXYDetails\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} \PY{k+kp}{as.matrix}\PY{p}{(}closeXY\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{,}\PY{l+m}{2}\PY{o}{:}\PY{l+m}{3}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{k+kp}{unlist}\PY{p}{(}distWeight\PY{p}{[[}i\PY{p}{]]}\PY{p}{)}
          \PY{p}{\PYZcb{}}
          
          estXY \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}estXYDetails\PY{p}{,}
                         \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{apply}\PY{p}{(}x\PY{p}{,} \PY{l+m}{2}\PY{p}{,}
                                           \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sum}\PY{p}{(}x\PY{p}{)}\PY{p}{)}\PY{p}{)}
            
          estXY \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} estXY\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}estXY\PY{p}{)}
        \PY{p}{\PYZcb{}}
        
        estXYknewalt \PY{o}{=} predXYalt\PY{p}{(}newSignals \PY{o}{=} onlineSummarynew\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{11}\PY{p}{]}\PY{p}{,} 
                         newAngles \PY{o}{=} onlineSummarynew\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                         offlineSummarynew\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} \PY{l+m}{6}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} calcError \PY{o}{=} 
        \PY{k+kr}{function}\PY{p}{(}estXY\PY{p}{,} actualXY\PY{p}{)} 
           \PY{k+kp}{sum}\PY{p}{(} \PY{k+kp}{rowSums}\PY{p}{(} \PY{p}{(}estXY \PY{o}{\PYZhy{}} actualXY\PY{p}{)}\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)} \PY{p}{)}
        
        actualXYnew \PY{o}{=} onlineSummarynew\PY{p}{[} \PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{]}
        \PY{k+kp}{sapply}\PY{p}{(}\PY{k+kt}{list}\PY{p}{(}estXYknew\PY{p}{,}estXYknewalt\PY{p}{)}\PY{p}{,} calcError\PY{p}{,} actualXYnew\PY{p}{)}
\end{Verbatim}


    \subsubsection{Code for Both MAC
Addresses}\label{code-for-both-mac-addresses}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} readDataBoth \PY{o}{=} 
           \PY{k+kr}{function}\PY{p}{(}filename \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{offline.final.trace.txt\PYZsq{}}\PY{p}{,} 
                    subMacs \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:e1:c0\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:8a\PYZdq{}}\PY{p}{,}
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:3b:c7:c6\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:90\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:8d\PYZdq{}}\PY{p}{,}
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{00:14:bf:b1:97:81\PYZdq{}}\PY{p}{)}\PY{p}{)}
           \PY{p}{\PYZob{}}
             txt \PY{o}{=} \PY{k+kp}{readLines}\PY{p}{(}filename\PY{p}{)}
             lines \PY{o}{=} txt\PY{p}{[} \PY{k+kp}{substr}\PY{p}{(}txt\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)} \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsh{}\PYZdq{}} \PY{p}{]}
             tmp \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}lines\PY{p}{,} processLine\PY{p}{)}
             offline2 \PY{o}{=} \PY{k+kp}{as.data.frame}\PY{p}{(}\PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} tmp\PY{p}{)}\PY{p}{,} 
                                     stringsAsFactors\PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)} 
             
             \PY{k+kp}{names}\PY{p}{(}offline2\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} 
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} 
                                \PY{l+s}{\PYZdq{}}\PY{l+s}{mac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}}\PY{p}{)}
             
              \PY{c+c1}{\PYZsh{} keep only signals from access points}
             offline2 \PY{o}{=} offline2\PY{p}{[} offline2\PY{o}{\PYZdl{}}type \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{3\PYZdq{}}\PY{p}{,} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} drop scanMac, posZ, channel, and type \PYZhy{} no info in them}
             dropVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{scanMac\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posZ\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{channel\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{type\PYZdq{}}\PY{p}{)}
             offline2 \PY{o}{=} offline2\PY{p}{[} \PY{p}{,} \PY{o}{!}\PY{p}{(} \PY{k+kp}{names}\PY{p}{(}offline2\PY{p}{)} \PY{o}{\PYZpc{}in\PYZpc{}} dropVars \PY{p}{)} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} drop more unwanted access points}
             offline2 \PY{o}{=} offline2\PY{p}{[} offline2\PY{o}{\PYZdl{}}mac \PY{o}{\PYZpc{}in\PYZpc{}} subMacs\PY{p}{,} \PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} convert numeric values}
             numVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{time\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{)}
             offline2\PY{p}{[} numVars \PY{p}{]} \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}offline2\PY{p}{[} numVars \PY{p}{]}\PY{p}{,} \PY{k+kp}{as.numeric}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} convert time to POSIX}
             offline2\PY{o}{\PYZdl{}}rawTime \PY{o}{=} offline2\PY{o}{\PYZdl{}}time
             offline2\PY{o}{\PYZdl{}}time \PY{o}{=} offline2\PY{o}{\PYZdl{}}time\PY{o}{/}\PY{l+m}{1000}
             \PY{k+kp}{class}\PY{p}{(}offline2\PY{o}{\PYZdl{}}time\PY{p}{)} \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXt\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{POSIXct\PYZdq{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} round orientations to nearest 45}
             offline2\PY{o}{\PYZdl{}}angle \PY{o}{=} roundOrientation\PY{p}{(}offline2\PY{o}{\PYZdl{}}orientation\PY{p}{)}
               
             \PY{k+kr}{return}\PY{p}{(}offline2\PY{p}{)}
           \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} offlineBoth \PY{o}{=} readDataBoth\PY{p}{(}\PY{p}{)}
         macChannel2 \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}offlineBoth\PY{p}{,} \PY{k+kp}{table}\PY{p}{(}mac\PY{p}{)}\PY{p}{)}
         \PY{k+kp}{apply}\PY{p}{(}macChannel2\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sum}\PY{p}{(}x \PY{o}{\PYZgt{}} \PY{l+m}{0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{description*}
\item[00:0f:a3:39:dd:cd] 1
\item[00:0f:a3:39:e1:c0] 1
\item[00:14:bf:3b:c7:c6] 1
\item[00:14:bf:b1:97:81] 1
\item[00:14:bf:b1:97:8a] 1
\item[00:14:bf:b1:97:8d] 1
\item[00:14:bf:b1:97:90] 1
\end{description*}


    
    \subsubsection{Code for Both MAC Address
Predictions}\label{code-for-both-mac-address-predictions}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} macs \PY{o}{=} \PY{k+kp}{unique}\PY{p}{(}offlineSummaryBoth\PY{o}{\PYZdl{}}mac\PY{p}{)}
        online \PY{o}{=} readData\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{online.final.trace.txt\PYZdq{}}\PY{p}{,} subMacs \PY{o}{=} macs\PY{p}{)}
        
        online\PY{o}{\PYZdl{}}posXY \PY{o}{=} \PY{k+kp}{paste}\PY{p}{(}online\PY{o}{\PYZdl{}}posX\PY{p}{,} online\PY{o}{\PYZdl{}}posY\PY{p}{,} sep \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZhy{}\PYZdq{}}\PY{p}{)}
        
        \PY{k+kp}{length}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}online\PY{o}{\PYZdl{}}posXY\PY{p}{)}\PY{p}{)}
        
        tabonlineXYA \PY{o}{=} \PY{k+kp}{table}\PY{p}{(}online\PY{o}{\PYZdl{}}posXY\PY{p}{,} online\PY{o}{\PYZdl{}}angle\PY{p}{)}
        tabonlineXYA\PY{p}{[}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{6}\PY{p}{,} \PY{p}{]}
        
        keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{angle\PYZdq{}}\PY{p}{)}
        byLoc \PY{o}{=} \PY{k+kp}{with}\PY{p}{(}online\PY{p}{,} 
                     \PY{k+kp}{by}\PY{p}{(}online\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{)}\PY{p}{,} 
                        \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{p}{\PYZob{}}
                          ans \PY{o}{=} x\PY{p}{[}\PY{l+m}{1}\PY{p}{,} keepVars\PY{p}{]}
                          avgSS \PY{o}{=} \PY{k+kp}{tapply}\PY{p}{(}x\PY{o}{\PYZdl{}}signal\PY{p}{,} x\PY{o}{\PYZdl{}}mac\PY{p}{,} \PY{k+kp}{mean}\PY{p}{)}
                          y \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}avgSS\PY{p}{,} nrow \PY{o}{=} \PY{l+m}{1}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{7}\PY{p}{,}
                                dimnames \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}ans\PY{o}{\PYZdl{}}posXY\PY{p}{,} \PY{k+kp}{names}\PY{p}{(}avgSS\PY{p}{)}\PY{p}{)}\PY{p}{)}
                          \PY{k+kp}{cbind}\PY{p}{(}ans\PY{p}{,} y\PY{p}{)}
                        \PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{)}
        
        onlineSummaryBoth \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} byLoc\PY{p}{)}  
        
        \PY{k+kp}{dim}\PY{p}{(}onlineSummaryBoth\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kp}{names}\PY{p}{(}onlineSummaryBoth\PY{p}{)}
        m \PY{o}{=} \PY{l+m}{3}\PY{p}{;} angleNewObs \PY{o}{=} \PY{l+m}{230}
        refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{,} length  \PY{o}{=} \PY{l+m}{8}\PY{p}{)}
        nearestAngle \PY{o}{=} roundOrientation\PY{p}{(}angleNewObs\PY{p}{)}
          
        \PY{k+kr}{if} \PY{p}{(}m \PY{o}{\PYZpc{}\PYZpc{}} \PY{l+m}{2} \PY{o}{==} \PY{l+m}{1}\PY{p}{)} \PY{p}{\PYZob{}}
          angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
        \PY{p}{\PYZcb{}} \PY{k+kr}{else} \PY{p}{\PYZob{}}
          m \PY{o}{=} m \PY{o}{+} \PY{l+m}{1}
          angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
          \PY{k+kr}{if} \PY{p}{(}\PY{k+kp}{sign}\PY{p}{(}angleNewObs \PY{o}{\PYZhy{}} nearestAngle\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m}{\PYZhy{}1}\PY{p}{)} 
            angles \PY{o}{=} angles\PY{p}{[} \PY{l+m}{\PYZhy{}1} \PY{p}{]}
          \PY{k+kr}{else} 
            angles \PY{o}{=} angles\PY{p}{[} \PY{o}{\PYZhy{}}m \PY{p}{]}
        \PY{p}{\PYZcb{}}
        angles \PY{o}{=} angles \PY{o}{+} nearestAngle
        angles\PY{p}{[}angles \PY{o}{\PYZlt{}} \PY{l+m}{0}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZlt{}} \PY{l+m}{0} \PY{p}{]} \PY{o}{+} \PY{l+m}{360}
        angles\PY{p}{[}angles \PY{o}{\PYZgt{}} \PY{l+m}{360}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZgt{}} \PY{l+m}{360} \PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m}{360}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} offlineSubset \PY{o}{=} 
          offlineSummaryBoth\PY{p}{[} offlineSummaryBoth\PY{o}{\PYZdl{}}angle \PY{o}{\PYZpc{}in\PYZpc{}} angles\PY{p}{,} \PY{p}{]}
        
        reshapeSS \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}data\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} 
                             keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
          byLocation \PY{o}{=}
            \PY{k+kp}{with}\PY{p}{(}data\PY{p}{,} \PY{k+kp}{by}\PY{p}{(}data\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{)}\PY{p}{,} 
                          \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{p}{\PYZob{}}
                            ans \PY{o}{=} x\PY{p}{[}\PY{l+m}{1}\PY{p}{,} keepVars\PY{p}{]}
                            avgSS \PY{o}{=} \PY{k+kp}{tapply}\PY{p}{(}x\PY{p}{[} \PY{p}{,} varSignal \PY{p}{]}\PY{p}{,} x\PY{o}{\PYZdl{}}mac\PY{p}{,} \PY{k+kp}{mean}\PY{p}{)}
                            y \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}avgSS\PY{p}{,} nrow \PY{o}{=} \PY{l+m}{1}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{7}\PY{p}{,}
                                       dimnames \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}ans\PY{o}{\PYZdl{}}posXY\PY{p}{,}
                                                       \PY{k+kp}{names}\PY{p}{(}avgSS\PY{p}{)}\PY{p}{)}\PY{p}{)}
                            \PY{k+kp}{cbind}\PY{p}{(}ans\PY{p}{,} y\PY{p}{)}
                          \PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{)}
        
          newDataSS \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} byLocation\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}newDataSS\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} trainSS \PY{o}{=} reshapeSS\PY{p}{(}offlineSubset\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{avgSignal\PYZdq{}}\PY{p}{)}
        
        selectTrain \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}angleNewObs\PY{p}{,} signals \PY{o}{=} \PY{k+kc}{NULL}\PY{p}{,} m \PY{o}{=} \PY{l+m}{1}\PY{p}{)}\PY{p}{\PYZob{}}
          \PY{c+c1}{\PYZsh{} m is the number of angles to keep between 1 and 5}
          refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{,} length  \PY{o}{=} \PY{l+m}{8}\PY{p}{)}
          nearestAngle \PY{o}{=} roundOrientation\PY{p}{(}angleNewObs\PY{p}{)}
          
          \PY{k+kr}{if} \PY{p}{(}m \PY{o}{\PYZpc{}\PYZpc{}} \PY{l+m}{2} \PY{o}{==} \PY{l+m}{1}\PY{p}{)} 
            angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
          \PY{k+kr}{else} \PY{p}{\PYZob{}}
            m \PY{o}{=} m \PY{o}{+} \PY{l+m}{1}
            angles \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{\PYZhy{}45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} \PY{l+m}{45} \PY{o}{*} \PY{p}{(}m \PY{o}{\PYZhy{}} \PY{l+m}{1}\PY{p}{)} \PY{o}{/}\PY{l+m}{2}\PY{p}{,} length \PY{o}{=} m\PY{p}{)}
            \PY{k+kr}{if} \PY{p}{(}\PY{k+kp}{sign}\PY{p}{(}angleNewObs \PY{o}{\PYZhy{}} nearestAngle\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m}{\PYZhy{}1}\PY{p}{)} 
              angles \PY{o}{=} angles\PY{p}{[} \PY{l+m}{\PYZhy{}1} \PY{p}{]}
            \PY{k+kr}{else} 
              angles \PY{o}{=} angles\PY{p}{[} \PY{o}{\PYZhy{}}m \PY{p}{]}
          \PY{p}{\PYZcb{}}
          angles \PY{o}{=} angles \PY{o}{+} nearestAngle
          angles\PY{p}{[}angles \PY{o}{\PYZlt{}} \PY{l+m}{0}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZlt{}} \PY{l+m}{0} \PY{p}{]} \PY{o}{+} \PY{l+m}{360}
          angles\PY{p}{[}angles \PY{o}{\PYZgt{}} \PY{l+m}{360}\PY{p}{]} \PY{o}{=} angles\PY{p}{[} angles \PY{o}{\PYZgt{}} \PY{l+m}{360} \PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m}{360}
          angles \PY{o}{=} \PY{k+kp}{sort}\PY{p}{(}angles\PY{p}{)} 
          
          offlineSubset \PY{o}{=} signals\PY{p}{[} signals\PY{o}{\PYZdl{}}angle \PY{o}{\PYZpc{}in\PYZpc{}} angles\PY{p}{,} \PY{p}{]}
          reshapeSS\PY{p}{(}offlineSubset\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{avgSignal\PYZdq{}}\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} train130 \PY{o}{=} selectTrain\PY{p}{(}\PY{l+m}{130}\PY{p}{,} offlineSummaryBoth\PY{p}{,} m \PY{o}{=} \PY{l+m}{3}\PY{p}{)}
        
        \PY{k+kp}{head}\PY{p}{(}train130\PY{p}{)}
        
        \PY{k+kp}{length}\PY{p}{(}train130\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}\PY{p}{)}
        
        findNN \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignal\PY{p}{,} trainSubset\PY{p}{)} \PY{p}{\PYZob{}}
          diffs \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}trainSubset\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{o}{:}\PY{l+m}{10}\PY{p}{]}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} 
                        \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x \PY{o}{\PYZhy{}} newSignal\PY{p}{)}
          dists \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}diffs\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sqrt}\PY{p}{(}\PY{k+kp}{sum}\PY{p}{(}x\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)}\PY{p}{)} \PY{p}{)}
          closest \PY{o}{=} \PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}trainSubset\PY{p}{[}closest\PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{3} \PY{p}{]}\PY{p}{)}
        \PY{p}{\PYZcb{}}
                        
        findNN2 \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignal\PY{p}{,} trainSubset\PY{p}{)} \PY{p}{\PYZob{}}
          diffs \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}trainSubset\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{o}{:}\PY{l+m}{10}\PY{p}{]}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} 
                        \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} x \PY{o}{\PYZhy{}} newSignal\PY{p}{)}
          dists \PY{o}{=} \PY{k+kp}{apply}\PY{p}{(}diffs\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sqrt}\PY{p}{(}\PY{k+kp}{sum}\PY{p}{(}x\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)}\PY{p}{)} \PY{p}{)}
          closest \PY{o}{=} \PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}\PY{k+kt}{list}\PY{p}{(}trainSubset\PY{p}{[}closest\PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{3} \PY{p}{]}\PY{p}{,}dists\PY{p}{[}\PY{k+kp}{order}\PY{p}{(}dists\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} predXYboth \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignals\PY{p}{,} newAngles\PY{p}{,} trainData\PY{p}{,} 
                          numAngles \PY{o}{=} \PY{l+m}{1}\PY{p}{,} k \PY{o}{=} \PY{l+m}{3}\PY{p}{)}\PY{p}{\PYZob{}}
          
          closeXY \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
            trainSS \PY{o}{=} selectTrain\PY{p}{(}newAngles\PY{p}{[}i\PY{p}{]}\PY{p}{,} trainData\PY{p}{,} m \PY{o}{=} numAngles\PY{p}{)}
            closeXY\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} 
              findNN\PY{p}{(}newSignal \PY{o}{=} \PY{k+kp}{as.numeric}\PY{p}{(}newSignals\PY{p}{[}i\PY{p}{,} \PY{p}{]}\PY{p}{)}\PY{p}{,} trainSS\PY{p}{)}
          \PY{p}{\PYZcb{}}
        
          estXY \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}closeXY\PY{p}{,} 
                         \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sapply}\PY{p}{(}x\PY{p}{[} \PY{p}{,} \PY{l+m}{2}\PY{o}{:}\PY{l+m}{3}\PY{p}{]}\PY{p}{,} 
                                            \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{mean}\PY{p}{(}x\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          estXY \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} estXY\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}estXY\PY{p}{)}
        \PY{p}{\PYZcb{}}
        estXYkBoth \PY{o}{=} predXYboth\PY{p}{(}newSignals \PY{o}{=} onlineSummaryBoth\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{12}\PY{p}{]}\PY{p}{,} 
                         newAngles \PY{o}{=} onlineSummaryBoth\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                         offlineSummaryBoth\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} \PY{l+m}{6}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Both MAC Address Althernative Location
Methodology}\label{both-mac-address-althernative-location-methodology}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} predXY \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}newSignals\PY{p}{,} newAngles\PY{p}{,} trainData\PY{p}{,} 
                          numAngles \PY{o}{=} \PY{l+m}{1}\PY{p}{,} k \PY{o}{=} \PY{l+m}{3}\PY{p}{)}\PY{p}{\PYZob{}}
          
          closeXY \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
          closeDist \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{nrow}\PY{p}{(}newSignals\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
            trainSS \PY{o}{=} selectTrain\PY{p}{(}newAngles\PY{p}{[}i\PY{p}{]}\PY{p}{,} trainData\PY{p}{,} m \PY{o}{=} numAngles\PY{p}{)}
            fnnResult \PY{o}{=}
            findNN2\PY{p}{(}newSignal \PY{o}{=} \PY{k+kp}{as.numeric}\PY{p}{(}newSignals\PY{p}{[}i\PY{p}{,} \PY{p}{]}\PY{p}{)}\PY{p}{,} trainSS\PY{p}{)}
          
            closeXY\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} fnnResult\PY{p}{[[}\PY{l+m}{1}\PY{p}{]]}
            closeDist\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} fnnResult\PY{p}{[[}\PY{l+m}{2}\PY{p}{]]}
          \PY{p}{\PYZcb{}}
          
          distWeight \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} \PY{k+kp}{length}\PY{p}{(}closeDist\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for} \PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{length}\PY{p}{(}closeDist\PY{p}{)}\PY{p}{)}\PY{p}{\PYZob{}}
            distW \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length \PY{o}{=} k\PY{p}{)}
        
            \PY{k+kr}{for} \PY{p}{(}j \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}k\PY{p}{)}\PY{p}{\PYZob{}}
              distW\PY{p}{[}j\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m}{1}\PY{o}{/}closeDist\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}j\PY{p}{]}\PY{p}{)}\PY{o}{/}\PY{k+kp}{sum}\PY{p}{(}\PY{l+m}{1}\PY{o}{/}closeDist\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{]}\PY{p}{)}
            \PY{p}{\PYZcb{}}
             
            distWeight\PY{p}{[[}i\PY{p}{]]} \PY{o}{=}  distW
          \PY{p}{\PYZcb{}}
        
          estXYDetails \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}length\PY{o}{=}\PY{k+kp}{length}\PY{p}{(}closeXY\PY{p}{)}\PY{p}{)}
          
          \PY{k+kr}{for}\PY{p}{(}i \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}\PY{k+kp}{length}\PY{p}{(}closeXY\PY{p}{)}\PY{p}{)}\PY{p}{\PYZob{}}
            estXYDetails\PY{p}{[[}i\PY{p}{]]} \PY{o}{=} \PY{k+kp}{as.matrix}\PY{p}{(}closeXY\PY{p}{[[}i\PY{p}{]]}\PY{p}{[}\PY{l+m}{1}\PY{o}{:}k\PY{p}{,}\PY{l+m}{2}\PY{o}{:}\PY{l+m}{3}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{k+kp}{unlist}\PY{p}{(}distWeight\PY{p}{[[}i\PY{p}{]]}\PY{p}{)}
          \PY{p}{\PYZcb{}}
          
          estXY \PY{o}{=} \PY{k+kp}{lapply}\PY{p}{(}estXYDetails\PY{p}{,}
                         \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{apply}\PY{p}{(}x\PY{p}{,} \PY{l+m}{2}\PY{p}{,}
                                           \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{k+kp}{sum}\PY{p}{(}x\PY{p}{)}\PY{p}{)}\PY{p}{)}
            
          estXY \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} estXY\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}estXY\PY{p}{)}
        \PY{p}{\PYZcb{}}
                        estXYkBothalt2 \PY{o}{=} predXY\PY{p}{(}newSignals \PY{o}{=} onlineSummaryBoth\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{12}\PY{p}{]}\PY{p}{,} 
                         newAngles \PY{o}{=} onlineSummaryBoth\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                         offlineSummaryBoth\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} \PY{l+m}{6}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} calcError \PY{o}{=} 
        \PY{k+kr}{function}\PY{p}{(}estXY\PY{p}{,} actualXY\PY{p}{)} 
           \PY{k+kp}{sum}\PY{p}{(} \PY{k+kp}{rowSums}\PY{p}{(} \PY{p}{(}estXY \PY{o}{\PYZhy{}} actualXY\PY{p}{)}\PY{o}{\PYZca{}}\PY{l+m}{2}\PY{p}{)} \PY{p}{)}
        
        actualXYBoth \PY{o}{=} onlineSummaryBoth\PY{p}{[} \PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{]}
        \PY{k+kp}{sapply}\PY{p}{(}\PY{k+kt}{list}\PY{p}{(}estXYkBoth\PY{p}{,}estXYkBothalt2\PY{p}{)}\PY{p}{,} calcError\PY{p}{,} actualXYBoth\PY{p}{)}
\end{Verbatim}


    \subsubsection{Code for Nearest Neighbor Minimized
Error}\label{code-for-nearest-neighbor-minimized-error}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} v \PY{o}{=} \PY{l+m}{11}
        \PY{k+kp}{set.seed}\PY{p}{(}\PY{l+m}{2019}\PY{p}{)}
        permuteLocs \PY{o}{=} \PY{k+kp}{sample}\PY{p}{(}\PY{k+kp}{unique}\PY{p}{(}offlineSummaryRedo\PY{o}{\PYZdl{}}posXY\PY{p}{)}\PY{p}{)}
        permuteLocs \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}permuteLocs\PY{p}{,} ncol \PY{o}{=} v\PY{p}{,} 
                             nrow \PY{o}{=} \PY{k+kp}{floor}\PY{p}{(}\PY{k+kp}{length}\PY{p}{(}permuteLocs\PY{p}{)}\PY{o}{/}v\PY{p}{)}\PY{p}{)}
        
        onlineFold \PY{o}{=} \PY{k+kp}{subset}\PY{p}{(}offlineSummaryRedo\PY{p}{,} posXY \PY{o}{\PYZpc{}in\PYZpc{}} permuteLocs\PY{p}{[} \PY{p}{,} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}
        
        reshapeSS \PY{o}{=} \PY{k+kr}{function}\PY{p}{(}data\PY{p}{,} varSignal \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{signal\PYZdq{}}\PY{p}{,} 
                             keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{,}
                             sampleAngle \PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{,} 
                             refs \PY{o}{=} \PY{k+kp}{seq}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{315}\PY{p}{,} by \PY{o}{=} \PY{l+m}{45}\PY{p}{)}\PY{p}{)} \PY{p}{\PYZob{}}
          \PY{k+kp}{set.seed}\PY{p}{(}\PY{l+m}{2019}\PY{p}{)}
            byLocation \PY{o}{=}
            \PY{k+kp}{with}\PY{p}{(}data\PY{p}{,} \PY{k+kp}{by}\PY{p}{(}data\PY{p}{,} \PY{k+kt}{list}\PY{p}{(}posXY\PY{p}{)}\PY{p}{,} 
                          \PY{k+kr}{function}\PY{p}{(}x\PY{p}{)} \PY{p}{\PYZob{}}
                            \PY{k+kr}{if} \PY{p}{(}sampleAngle\PY{p}{)} \PY{p}{\PYZob{}}
                              x \PY{o}{=} x\PY{p}{[}x\PY{o}{\PYZdl{}}angle \PY{o}{==} \PY{k+kp}{sample}\PY{p}{(}refs\PY{p}{,} size \PY{o}{=} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} \PY{p}{]}\PY{p}{\PYZcb{}}
                            ans \PY{o}{=} x\PY{p}{[}\PY{l+m}{1}\PY{p}{,} keepVars\PY{p}{]}
                            avgSS \PY{o}{=} \PY{k+kp}{tapply}\PY{p}{(}x\PY{p}{[} \PY{p}{,} varSignal \PY{p}{]}\PY{p}{,} x\PY{o}{\PYZdl{}}mac\PY{p}{,} \PY{k+kp}{mean}\PY{p}{)}
                            y \PY{o}{=} \PY{k+kt}{matrix}\PY{p}{(}avgSS\PY{p}{,} nrow \PY{o}{=} \PY{l+m}{1}\PY{p}{,} ncol \PY{o}{=} \PY{l+m}{6}\PY{p}{,}
                                       dimnames \PY{o}{=} \PY{k+kt}{list}\PY{p}{(}ans\PY{o}{\PYZdl{}}posXY\PY{p}{,}
                                                       \PY{k+kp}{names}\PY{p}{(}avgSS\PY{p}{)}\PY{p}{)}\PY{p}{)}
                            \PY{k+kp}{cbind}\PY{p}{(}ans\PY{p}{,} y\PY{p}{)}
                          \PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{)}
        
          newDataSS \PY{o}{=} \PY{k+kp}{do.call}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{rbind\PYZdq{}}\PY{p}{,} byLocation\PY{p}{)}
          \PY{k+kr}{return}\PY{p}{(}newDataSS\PY{p}{)}
        \PY{p}{\PYZcb{}}
        
        offline \PY{o}{=} offlineRedo\PY{p}{[} offlineRedo\PY{o}{\PYZdl{}}mac \PY{o}{!=} \PY{l+s}{\PYZdq{}}\PY{l+s}{00:0f:a3:39:dd:cd\PYZdq{}}\PY{p}{,} \PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} keepVars \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posXY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orientation\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{angle\PYZdq{}}\PY{p}{)}
        
        onlineCVSummary \PY{o}{=} reshapeSS\PY{p}{(}offline\PY{p}{,} keepVars \PY{o}{=} keepVars\PY{p}{,} 
                                    sampleAngle \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{)}
        
        onlineFold \PY{o}{=} \PY{k+kp}{subset}\PY{p}{(}onlineCVSummary\PY{p}{,} 
                            posXY \PY{o}{\PYZpc{}in\PYZpc{}} permuteLocs\PY{p}{[} \PY{p}{,} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}
        
        offlineFold \PY{o}{=} \PY{k+kp}{subset}\PY{p}{(}offlineSummaryRedo\PY{p}{,}
                             posXY \PY{o}{\PYZpc{}in\PYZpc{}} permuteLocs\PY{p}{[} \PY{p}{,} \PY{l+m}{\PYZhy{}1}\PY{p}{]}\PY{p}{)}
        
        estFold \PY{o}{=} predXY\PY{p}{(}newSignals \PY{o}{=} onlineFold\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{11}\PY{p}{]}\PY{p}{,} 
                         newAngles \PY{o}{=} onlineFold\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                         offlineFold\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} \PY{l+m}{3}\PY{p}{)}
        
        actualFold \PY{o}{=} onlineFold\PY{p}{[} \PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{]}
        calcError\PY{p}{(}estFold\PY{p}{,} actualFold\PY{p}{)}
        
        K \PY{o}{=} \PY{l+m}{20}
        err \PY{o}{=} \PY{k+kp}{rep}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} K\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kr}{for} \PY{p}{(}j \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}v\PY{p}{)} \PY{p}{\PYZob{}}
          onlineFold \PY{o}{=} \PY{k+kp}{subset}\PY{p}{(}onlineCVSummary\PY{p}{,} 
                              posXY \PY{o}{\PYZpc{}in\PYZpc{}} permuteLocs\PY{p}{[} \PY{p}{,} j\PY{p}{]}\PY{p}{)}
          offlineFold \PY{o}{=} \PY{k+kp}{subset}\PY{p}{(}offlineSummaryRedo\PY{p}{,}
                               posXY \PY{o}{\PYZpc{}in\PYZpc{}} permuteLocs\PY{p}{[} \PY{p}{,} \PY{o}{\PYZhy{}}j\PY{p}{]}\PY{p}{)}
          actualFold \PY{o}{=} onlineFold\PY{p}{[} \PY{p}{,} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{posX\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{posY\PYZdq{}}\PY{p}{)}\PY{p}{]}
          
          \PY{k+kr}{for} \PY{p}{(}k \PY{k+kr}{in} \PY{l+m}{1}\PY{o}{:}K\PY{p}{)} \PY{p}{\PYZob{}}
            estFold \PY{o}{=} predXY\PY{p}{(}newSignals \PY{o}{=} onlineFold\PY{p}{[} \PY{p}{,} \PY{l+m}{6}\PY{o}{:}\PY{l+m}{11}\PY{p}{]}\PY{p}{,}
                             newAngles \PY{o}{=} onlineFold\PY{p}{[} \PY{p}{,} \PY{l+m}{4}\PY{p}{]}\PY{p}{,} 
                             offlineFold\PY{p}{,} numAngles \PY{o}{=} \PY{l+m}{3}\PY{p}{,} k \PY{o}{=} k\PY{p}{)}
            err\PY{p}{[}k\PY{p}{]} \PY{o}{=} err\PY{p}{[}k\PY{p}{]} \PY{o}{+} calcError\PY{p}{(}estFold\PY{p}{,} actualFold\PY{p}{)}
          \PY{p}{\PYZcb{}}
        \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}pdf(file = \PYZdq{}Geo\PYZus{}CVChoiceOfK.pdf\PYZdq{}, width = 10, height = 6)}
        oldPar \PY{o}{=} par\PY{p}{(}mar \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{4}\PY{p}{,} \PY{l+m}{3}\PY{p}{,} \PY{l+m}{1}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{)}
        plot\PY{p}{(}y \PY{o}{=} err\PY{p}{,} x \PY{o}{=} \PY{p}{(}\PY{l+m}{1}\PY{o}{:}K\PY{p}{)}\PY{p}{,}  type \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{l\PYZdq{}}\PY{p}{,} lwd\PY{o}{=} \PY{l+m}{2}\PY{p}{,}
             ylim \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1000}\PY{p}{,} \PY{l+m}{2100}\PY{p}{)}\PY{p}{,}
             xlab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Number of Neighbors\PYZdq{}}\PY{p}{,}
             ylab \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Sum of Square Errors\PYZdq{}}\PY{p}{)}
        
        rmseMin \PY{o}{=} \PY{k+kp}{min}\PY{p}{(}err\PY{p}{)}
        kMin \PY{o}{=} \PY{k+kp}{which}\PY{p}{(}err \PY{o}{==} rmseMin\PY{p}{)}\PY{p}{[}\PY{l+m}{1}\PY{p}{]}
        segments\PY{p}{(}x0 \PY{o}{=} \PY{l+m}{0}\PY{p}{,} x1 \PY{o}{=} kMin\PY{p}{,} y0 \PY{o}{=} rmseMin\PY{p}{,} col \PY{o}{=} gray\PY{p}{(}\PY{l+m}{0.4}\PY{p}{)}\PY{p}{,} 
                 lty \PY{o}{=} \PY{l+m}{2}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
        segments\PY{p}{(}x0 \PY{o}{=} kMin\PY{p}{,} x1 \PY{o}{=} kMin\PY{p}{,} y0 \PY{o}{=} \PY{l+m}{900}\PY{p}{,}  y1 \PY{o}{=} rmseMin\PY{p}{,} 
                 col \PY{o}{=} grey\PY{p}{(}\PY{l+m}{0.4}\PY{p}{)}\PY{p}{,} lty \PY{o}{=} \PY{l+m}{2}\PY{p}{,} lwd \PY{o}{=} \PY{l+m}{2}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}mtext(kMin, side = 1, line = 1, at = kMin, col = grey(0.4))}
        text\PY{p}{(}x \PY{o}{=} kMin \PY{o}{\PYZhy{}} \PY{l+m}{2}\PY{p}{,} y \PY{o}{=} rmseMin \PY{o}{+} \PY{l+m}{40}\PY{p}{,} 
             label \PY{o}{=} \PY{k+kp}{as.character}\PY{p}{(}\PY{k+kp}{round}\PY{p}{(}rmseMin\PY{p}{)}\PY{p}{)}\PY{p}{,} col \PY{o}{=} grey\PY{p}{(}\PY{l+m}{0.4}\PY{p}{)}\PY{p}{)}
        par\PY{p}{(}oldPar\PY{p}{)}
        dev.off\PY{p}{(}\PY{p}{)}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
